<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="UTF-8"/>
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"/><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="generator" content="Asciidoctor 1.5.2"/>
<meta name="author" content="Andrey Antukh, Alejandro Gomez"/>
<title>ClojureScript Unraveled</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white;
       color: rgba(0, 0, 0, 0.8);
       padding: 0;
       margin: 0;
       font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica,Arial,sans-serif;
       font-weight: normal;
       font-style: normal;
       line-height: 1;
       position: relative;
       cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #7a2518; font-weight: normal; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2156a5; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #1d4b8f; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
    font-weight: 300;
    font-style: normal;

    font-family: "Roboto Slab", "ff-tisa-web-pro","Georgia",Arial,sans-serif;
    color: #3E4349;

    text-rendering: optimizeLegibility;
    margin-top: 1em;
    margin-bottom: 0.5em;
    line-height: 1.0125em;
}
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small {
    font-size: 60%;
    color: #527bbd;
    line-height: 0;
}

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code {
    font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
    font-family: "Liberation Mono",Menlo,Courier,monospace;
    font-weight: normal; color: rgba(0, 0, 0, 0.9);
}

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: rgba(0, 0, 0, 0.8); border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: rgba(0, 0, 0, 0.8); }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f8; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; }

pre, pre > code {
    line-height: 1.45;
    color: rgba(0, 0, 0, 0.9);
    font-family: "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace;
    font-family: "Liberation Mono",Menlo,Courier,monospace;
    font-weight: normal;
    text-rendering: optimizeSpeed; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { display: inline-block; color: rgba(0, 0, 0, 0.8); font-size: 0.75em; line-height: 1.4; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: rgba(0, 0, 0, 0.8); }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Open Sans", "DejaVu Sans", sans-serif; list-style-type: none; }
#toc a { text-decoration: none;
         color: #3E4349;
       }
#toc a:active { text-decoration: underline; }

#toctitle { font-size: 1.2em; font-weight: 700; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f8f8f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 25em; padding-right: 0; }
  #toc.toc2 { width: 25em; font-size: 16px; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: rgba(0, 0, 0, 0.8); padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }

#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link {
    text-decoration: none;
    color: #3E4349;
    font-weight: 700;
}

#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #3E4349; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Noto Serif", "DejaVu Serif", serif; font-size: 1rem; font-style: italic; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Open Sans", "DejaVu Sans", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f8f8f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f8; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f8; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #7a2518; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.05em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 0 1.25em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.spread { width: 100%; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: rgba(0, 0, 0, 0.8); font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .75em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
span.footnote a:active, span.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #19407c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: rgba(0, 0, 0, 0.8); -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2 { letter-spacing: -0.01em; }

dt, th.tableblock, td.content { text-rendering: optimizeLegibility; }

p, td.content { letter-spacing: -0.01em; }
p strong, td.content strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@media print { @page { margin: 1.25cm 0.75cm; }
  * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
  a { color: inherit !important; text-decoration: underline !important; }
  a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
  a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  pre, blockquote, tr, img { page-break-inside: avoid; }
  thead { display: table-header-group; }
  img { max-width: 100% !important; }
  p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
  #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
  .sect1 { padding-bottom: 0 !important; }
  .sect1 + .sect1 { border: 0 !important; }
  #header > h1:first-child { margin-top: 1.25rem; }
  body.book #header { text-align: center; }
  body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
  body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
  body.book #header .details span:first-child { margin-left: 0 !important; }
  body.book #header .details br { display: block; }
  body.book #header .details br + span:before { content: none !important; }
  body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
  body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
  .listingblock code[data-lang]:before { display: block; }
  #footer { background: none !important; padding: 0 0.9375em; }
  #footer-text { color: rgba(0, 0, 0, 0.6) !important; font-size: 0.9em; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }

</style>
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments  { background: #f0f0f0; }
.listingblock .pygments .tok-c { color: #60a0b0; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #007020; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #007020 } /* Comment.Preproc */
.listingblock .pygments .tok-c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #007020 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #902000 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #40a070 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #4070a0 } /* Literal.String */
.listingblock .pygments .tok-na { color: #4070a0 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #007020 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #60add5 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #555555; font-weight: bold } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #d55537; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #007020 } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #06287e } /* Name.Function */
.listingblock .pygments .tok-nl { color: #002070; font-weight: bold } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #062873; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #bb60d5 } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #007020; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #40a070 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #40a070 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #40a070 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #40a070 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #40a070 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sb { color: #4070a0 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #4070a0 } /* Literal.String.Char */
.listingblock .pygments .tok-sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #4070a0 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #4070a0 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #c65d09 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #235388 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #4070a0 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #517918 } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #007020 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-vc { color: #bb60d5 } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #bb60d5 } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #bb60d5 } /* Name.Variable.Instance */
.listingblock .pygments .tok-il { color: #40a070 } /* Literal.Number.Integer.Long */
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Liberation+Mono:400|Roboto+Slab:400,700"/>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>ClojureScript Unraveled</h1>
<div class="details">
<span id="author" class="author">Andrey Antukh</span><br/>
<span id="email" class="email"><a href="mailto:niwi@niwi.be">niwi@niwi.be</a></span><br/>
<span id="author2" class="author">Alejandro Gomez</span><br/>
<span id="email2" class="email"><a href="mailto:alejandro@dialelo.com">alejandro@dialelo.com</a></span><br/>
<span id="revnumber">version 1,</span>
<span id="revdate">2015-05-04</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#first-contact">1.1. First contact</a></li>
<li><a href="#the-pillars-of-the-language">1.2. The pillars of the language</a></li>
<li><a href="#why-host-on-javascript">1.3. Why host on JavaScript?</a></li>
</ul>
</li>
<li><a href="#the-language">2. The language.</a>
<ul class="sectlevel2">
<li><a href="#first-steps-with-lisp-syntax">2.1. First steps with Lisp syntax</a></li>
<li><a href="#the-base-data-types">2.2. The base data types</a>
<ul class="sectlevel3">
<li><a href="#numbers">2.2.1. Numbers</a></li>
<li><a href="#keywords">2.2.2. Keywords</a></li>
<li><a href="#symbols">2.2.3. Symbols</a></li>
<li><a href="#strings">2.2.4. Strings</a></li>
<li><a href="#characters">2.2.5. Characters</a></li>
<li><a href="#collections">2.2.6. Collections</a></li>
</ul>
</li>
<li><a href="#vars">2.3. Vars</a></li>
<li><a href="#functions">2.4. Functions</a>
<ul class="sectlevel3">
<li><a href="#the-first-contact">2.4.1. The first contact</a></li>
<li><a href="#defining-your-own-functions">2.4.2. Defining your own functions</a></li>
<li><a href="#function-with-multiple-arities">2.4.3. Function with multiple arities</a></li>
<li><a href="#variadic-functions">2.4.4. Variadic functions</a></li>
<li><a href="#short-syntax-for-anonymous-functions">2.4.5. Short syntax for anonymous functions</a></li>
</ul>
</li>
<li><a href="#flow-control">2.5. Flow control</a>
<ul class="sectlevel3">
<li><a href="#branching-with-code-if-code">2.5.1. Branching with <code>if</code></a></li>
<li><a href="#branching-with-code-cond-code">2.5.2. Branching with <code>cond</code></a></li>
<li><a href="#branching-with-code-case-code">2.5.3. Branching with <code>case</code></a></li>
</ul>
</li>
<li><a href="#locals-blocks-and-loops">2.6. Locals, Blocks and Loops</a>
<ul class="sectlevel3">
<li><a href="#locals">2.6.1. Locals</a></li>
<li><a href="#blocks">2.6.2. Blocks</a></li>
<li><a href="#loops">2.6.3. Loops</a></li>
</ul>
</li>
<li><a href="#collection-types">2.7. Collection types</a>
<ul class="sectlevel3">
<li><a href="#immutable-and-persistent">2.7.1. Immutable and persistent</a></li>
<li><a href="#the-sequence-abstraction">2.7.2. The sequence abstraction</a></li>
<li><a href="#collections-in-depth">2.7.3. Collections in depth</a></li>
</ul>
</li>
<li><a href="#destructuring">2.8. Destructuring</a></li>
<li><a href="#namespaces">2.9. Namespaces</a>
<ul class="sectlevel3">
<li><a href="#defining-a-namespace">2.9.1. Defining a namespace</a></li>
<li><a href="#loading-other-namespaces">2.9.2. Loading other namespaces</a></li>
</ul>
</li>
<li><a href="#abstractions-and-polymorphism">2.10. Abstractions and Polymorphism</a>
<ul class="sectlevel3">
<li><a href="#protocols">2.10.1. Protocols</a></li>
<li><a href="#multimethods">2.10.2. Multimethods</a></li>
<li><a href="#hierarchies">2.10.3. Hierarchies</a></li>
</ul>
</li>
<li><a href="#data-types">2.11. Data types</a>
<ul class="sectlevel3">
<li><a href="#deftype">2.11.1. Deftype</a></li>
<li><a href="#defrecord">2.11.2. Defrecord</a></li>
<li><a href="#implementing-protocols">2.11.3. Implementing protocols</a></li>
<li><a href="#reify">2.11.4. Reify</a></li>
</ul>
</li>
<li><a href="#host-interoperability">2.12. Host interoperability</a>
<ul class="sectlevel3">
<li><a href="#the-types">2.12.1. The types.</a></li>
<li><a href="#interacting-with-platform-types">2.12.2. Interacting with platform types</a></li>
</ul>
</li>
<li><a href="#state-management">2.13. State management</a></li>
<li><a href="#truthiness">2.14. Truthiness</a></li>
<li><a href="#transducers">2.15. Transducers</a></li>
<li><a href="#metadata">2.16. Metadata</a></li>
<li><a href="#a-little-overview-of-macros">2.17. A little overview of macros</a></li>
</ul>
</li>
<li><a href="#tooling-compiler">3. Tooling &amp; Compiler</a>
<ul class="sectlevel2">
<li><a href="#getting-started-with-the-clojurescript-compiler">3.1. Getting Started with the ClojureScript compiler</a>
<ul class="sectlevel3">
<li><a href="#execution-environments">3.1.1. Execution environments</a></li>
<li><a href="#download-the-compiler">3.1.2. Download the compiler</a></li>
<li><a href="#compile-for-nodejs-iojs">3.1.3. Compile for nodejs/iojs</a></li>
<li><a href="#compile-for-the-browser">3.1.4. Compile for the Browser</a></li>
<li><a href="#watch-process">3.1.5. Watch process</a></li>
<li><a href="#optimization-levels">3.1.6. Optimization levels</a></li>
</ul>
</li>
<li><a href="#working-with-the-repl">3.2. Working with the REPL</a>
<ul class="sectlevel3">
<li><a href="#introduction-2">3.2.1. Introduction</a></li>
<li><a href="#node-repl">3.2.2. Node REPL</a></li>
<li><a href="#nashorn-repl">3.2.3. Nashorn REPL</a></li>
<li><a href="#browser-repl">3.2.4. Browser REPL</a></li>
</ul>
</li>
<li><a href="#build-and-dependency-management-tools">3.3. Build and Dependency management tools</a>
<ul class="sectlevel3">
<li><a href="#getting-started-with-leiningen">3.3.1. Getting started with Leiningen.</a></li>
<li><a href="#getting-started-with-boot">3.3.2. Getting started with boot.</a></li>
</ul>
</li>
<li><a href="#the-closure-library">3.4. The Closure Library</a></li>
<li><a href="#browser-based-development">3.5. Browser based development</a>
<ul class="sectlevel3">
<li><a href="#using-third-party-javascript-libraries">3.5.1. Using third party JavaScript libraries</a></li>
<li><a href="#modularizing-your-code">3.5.2. Modularizing your code</a></li>
</ul>
</li>
<li><a href="#developing-a-library">3.6. Developing a library</a></li>
<li><a href="#unit-testing">3.7. Unit testing</a></li>
</ul>
</li>
<li><a href="#mixed-bag">4. Mixed Bag</a>
<ul class="sectlevel2">
<li><a href="#async-primitives-using-core-async">4.1. Async primitives using core.async.</a></li>
<li><a href="#working-with-promises">4.2. Working with promises.</a></li>
<li><a href="#error-handling-using-monads-and-cats">4.3. Error handling using monads and Cats.</a></li>
<li><a href="#pattern-matching-using-core-match">4.4. Pattern matching using core.match.</a></li>
<li><a href="#web-development-with-om-and-react">4.5. Web development with Om and React.</a></li>
<li><a href="#writing-libraries-that-shares-code-between-clojure-and-clojurescript">4.6. Writing libraries that shares code between Clojure and ClojureScript.</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="link" href="#introduction">1. Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter is an introduction to the Clojure ecosystem, and intends to explain
the philosophy behind it.</p>
</div>
<div class="sect2">
<h3 id="first-contact"><a class="link" href="#first-contact">1.1. First contact</a></h3>
<div class="paragraph">
<p><em>ClojureScript</em> is an implementation of the Clojure programming language that
targets JavaScript. Because of this it can run in many different execution
environments including web browsers, Node.js, io.js, and Nashhorn.</p>
</div>
<div class="paragraph">
<p>Unlike other languages that intend to <em>compile</em> to JavaScript (like TypeScript,
FunScript or CoffeeScript), ClojureScript is designed to use JavaScript like bytecode. It embraces
functional programming, and has very safe and consistent defaults.</p>
</div>
<div class="paragraph">
<p>Another big difference (and in my opinion a big advantage) over other languages is that Clojure
is designed to be a guest. It is a language without its own virtual machine that
can be easy adapted to differences between its execution environments.</p>
</div>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="the-pillars-of-the-language"><a class="link" href="#the-pillars-of-the-language">1.2. The pillars of the language</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="why-host-on-javascript"><a class="link" href="#why-host-on-javascript">1.3. Why host on JavaScript?</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-language"><a class="link" href="#the-language">2. The language.</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will be a little introduction to ClojureScript without assumptions about previous
knowledge of the Clojure language, providing a quick tour over all the things you will need to know
in order to understand the rest of this book.</p>
</div>
<div class="sect2">
<h3 id="first-steps-with-lisp-syntax"><a class="link" href="#first-steps-with-lisp-syntax">2.1. First steps with Lisp syntax</a></h3>
<div class="paragraph">
<p>Invented by John McCarthy in 1958, Lisp is one of the oldest programming languages that is still
around. It has evolved into many derivatives called dialects, and ClojureScript is
one of them. It&#8217;s a programming language written in its own data structures, originally lists enclosed in
parentheses, but Clojure(Script) has evolved the Lisp syntax with more data structures, making
it more pleasant to write and read.</p>
</div>
<div class="paragraph">
<p>A list with a function in the first position is used for calling a function in ClojureScript:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, we&#8217;re applying the addition function <code>+</code> to the arguments 1, 2 and 3. ClojureScript
allows many unusual characters like <code>?</code> or <code>-</code> in symbol names, which makes it easier to read:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">zero? </span><span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For distinguishing function calls and lists, we can quote lists to keep them from being evaluated. The quoted
lists will be treated as data instead of as a function call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (+ 1 2 3)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ClojureScript uses more than lists for its syntax. The full details will be covered later, but here is an
example of the usage of a vector (enclosed in brackets) for defining local bindings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-mi">1</span>
      <span class="tok-nv">y</span> <span class="tok-mi">2</span>
      <span class="tok-nv">z</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-nv">y</span> <span class="tok-nv">z</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; 6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is practically all the syntax we need to know for using not only ClojureScript, but any Lisp. Being
written in its own data structures (often referred to as <em>homoiconicity</em>) is a great property since the
syntax is uniform and simple; also, code generation via macros is easier than in any other language, giving
us plenty of power for extending the language to suit our needs.</p>
</div>
</div>
<div class="sect2">
<h3 id="the-base-data-types"><a class="link" href="#the-base-data-types">2.2. The base data types</a></h3>
<div class="paragraph">
<p>The ClojureScript language has a rich set of data types like most programming languages. It provides
scalar datatypes that will be very familiar to you, such as numbers, strings, and floats. Beyond these, it also
provides a great number of others that might be less familiar, such as symbols, keywords, regex (regular expressions),
vars, atoms, volatiles&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p><em>ClojureScript</em> embraces the host language, and where possible it uses the host&#8217;s provided types. For example:
numbers and strings are used as is and they behave in same way as in JavaScript.</p>
</div>
<div class="sect3">
<h4 id="numbers"><a class="link" href="#numbers">2.2.1. Numbers</a></h4>
<div class="paragraph">
<p>In <em>ClojureScript</em>,  numbers include both integers and floating points. Keeping in mind that
<em>ClojureScript</em> is a guest language that compiles to JavaScript, integers are actually JavaScript&#8217;s native
floating points under the hood.</p>
</div>
<div class="paragraph">
<p>As in any other language, numbers in <em>ClojureScript</em> are represented in following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-mi">23</span>
<span class="tok-nv">+23</span>
<span class="tok-mi">-100</span>
<span class="tok-mf">1.7</span>
<span class="tok-mi">-2</span>
<span class="tok-mi">33</span><span class="tok-nv">e8</span>
<span class="tok-mi">12</span><span class="tok-nv">e-14</span>
<span class="tok-mf">3.2</span><span class="tok-nv">e-4</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="keywords"><a class="link" href="#keywords">2.2.2. Keywords</a></h4>
<div class="paragraph">
<p>Keywords in <em>ClojureScript</em> are objects that always evaluate to themselves. They are usually
used in map data structures to efficiently represent the keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-ss">:foobar</span>
<span class="tok-ss">:2</span>
<span class="tok-ss">:?</span>
<span class="tok-ss">:foo/bar</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the keywords are all prefixed with <code>:</code>, but this character is only part
of the literal syntax and is not part of the name of the object.</p>
</div>
<div class="paragraph">
<p>You can also create a keyword by calling the <code>keyword</code> function. Don&#8217;t worry if you don&#8217;t understand
or are unclear about anything in the following example; the functions are discussed in later chapters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">keyword </span><span class="tok-s">&quot;foo&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; :foo</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="symbols"><a class="link" href="#symbols">2.2.3. Symbols</a></h4>
<div class="paragraph">
<p>Symbols in <em>ClojureScript</em> are very, very similar to <strong>Keywords</strong> (which you now know about). But
instead of evaluating to themselves, symbols are evaluated to something that they refer to, that
can be functions, variables, etc.</p>
</div>
<div class="paragraph">
<p>Symbols are represented with something that does not start with a number:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-nv">sample-symbol</span>
<span class="tok-nv">othersymbol</span>
<span class="tok-nv">f1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t worry if you don&#8217;t understand right away; symbols are used in almost
all of our examples, which will give you the opportunity to learn more as we go on.</p>
</div>
</div>
<div class="sect3">
<h4 id="strings"><a class="link" href="#strings">2.2.4. Strings</a></h4>
<div class="paragraph">
<p>There is almost nothing new we can explain about strings that you don&#8217;t already know. In <em>ClojureScript</em>, they
 work the same as in any other language. One point of interest, however, is that they are immutable.</p>
</div>
<div class="paragraph">
<p>In this case they are the same as in JavaScript:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-s">&quot;A example of a string&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>One peculiar aspect of Strings in <em>ClojureScript</em> is due to the language&#8217;s Lisp syntax: single and multiline strings
have the same syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-s">&quot;This is a multiline</span>
<span class="tok-s">      string in ClojureScript.&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="characters"><a class="link" href="#characters">2.2.5. Characters</a></h4>
<div class="paragraph">
<p><em>ClojureScript</em> also lets you write single characters using Clojure&#8217;s character literal syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-sc">\a</span>        <span class="tok-c1">; The lowercase a character</span>
<span class="tok-sc">\n</span><span class="tok-nv">ewline</span>  <span class="tok-c1">; The new line character</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the host language doesn&#8217;t contain character literals, <em>ClojureScript</em> characters are transformed
behind the scenes into single character JavaScript strings.</p>
</div>
</div>
<div class="sect3">
<h4 id="collections"><a class="link" href="#collections">2.2.6. Collections</a></h4>
<div class="paragraph">
<p>Another big step in explaining a language is to explain its collections and collection
abstractions. <em>ClojureScript</em> is not an exception to this rule.</p>
</div>
<div class="paragraph">
<p><em>ClojureScript</em> comes with many types of different collections. The main difference between <em>ClojureScript</em>
collections and collections in other languages is that they are persistent and immutable.</p>
</div>
<div class="paragraph">
<p>Before moving on to all of these (possibly) unknown concepts, we&#8217;ll present a high level overview
of existing collection types in <em>ClojureScript</em>.</p>
</div>
<div class="sect4">
<h5 id="lists"><a class="link" href="#lists">Lists</a></h5>
<div class="paragraph">
<p>This is a classic collection type in languages based on Lisp. Lists are the
simplest type of collection in <em>ClojureScript</em>. Lists can contain items of any type, including
other collections.</p>
</div>
<div class="paragraph">
<p>Lists in <em>ClojureScript</em> are represented by items enclosed between parentheses:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">)</span>
<span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-ss">:foo</span> <span class="tok-ss">:bar</span> <span class="tok-mi">2</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, all list examples are prefixed with the <code>'</code> char. This is because lists in Lisp like
languages are often used to express things like function or macro calls. In that case
the first item should be a symbol that will evaluate to a something callable, and the rest of the list
elements will be function parameters. However, in the preceding examples, we don&#8217;t want the first item as a symbol;
we just want a list of items.  The following example shows the difference between a list without and with the preceding
single quote mark:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">inc </span><span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 2</span>

<span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-nb">inc </span><span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (inc 1)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you see, if you  evaluate <code>(inc 1)</code> without prefixing it with <code>'</code>, it will resolve
the <code>inc</code> symbol to the <strong>inc</strong> function and will execute it with <code>1</code> as first parameter returning the value <code>2</code>.</p>
</div>
<div class="paragraph">
<p>You can also explicitly create a list with the <code>list</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">list </span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (1 2 3 4 5)</span>

<span class="tok-p">(</span><span class="tok-nb">list </span><span class="tok-ss">:foo</span> <span class="tok-ss">:bar</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (:foo :bar 2)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lists have the pecularity that they are very efficient if you access them sequentially or
access their first elements, but a list is not a very good option if you need random (index) access to it&#8217;s
elements.</p>
</div>
</div>
<div class="sect4">
<h5 id="vectors"><a class="link" href="#vectors">Vectors</a></h5>
<div class="paragraph">
<p>Like lists, <strong>Vectors</strong>  store a series of values, but in this case with very efficient index access
to their elements, as opposed to lists, which are evaluated in order. Don&#8217;t worry; in
the following chapters we&#8217;ll go in depth with details, but at this moment, this simple explanation is
more than enough.</p>
</div>
<div class="paragraph">
<p>Vectors use square brackets for the literal syntax; let&#8217;s see some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">[</span><span class="tok-ss">:foo</span> <span class="tok-ss">:bar</span><span class="tok-p">]</span>
<span class="tok-p">[</span><span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">5</span> <span class="tok-nv">nil</span><span class="tok-p">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Like lists, vectors can contain objects of any type, as you can observe in the preceding example.</p>
</div>
<div class="paragraph">
<p>You can also explicitly create a vector with the <code>vector</code> function, but this is not commonly used in ClojureScript programs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">vector </span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [1 2 3]</span>

<span class="tok-p">(</span><span class="tok-nb">vector </span><span class="tok-s">&quot;blah&quot;</span> <span class="tok-mf">3.5</span> <span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [&quot;blah&quot; 3.5 nil]</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maps"><a class="link" href="#maps">Maps</a></h5>
<div class="paragraph">
<p>Maps are a collection abstraction that allows you to store key/value pairs. In other
languages this type of structure is commonly known as a hash-map or dicts (dictionaries). Map literals
in <em>ClojureScript</em> are written with the pairs between curly braces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">{</span><span class="tok-ss">:foo</span> <span class="tok-s">&quot;bar&quot;</span>, <span class="tok-ss">:baz</span> <span class="tok-mi">2</span><span class="tok-p">}</span>
<span class="tok-p">{</span><span class="tok-ss">:alphabet</span> <span class="tok-p">[</span><span class="tok-ss">:a</span> <span class="tok-ss">:b</span> <span class="tok-ss">:c</span><span class="tok-p">]}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Commas are frequently used to separate a key-value pair but are completely optional. In
<em>ClojureScript</em> syntax, commas are treated like spaces.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Like Vectors, every item in a map literal is evaluated before the result is stored in a map, but
the order of evaluation is not guaranteed.</p>
</div>
</div>
<div class="sect4">
<h5 id="sets"><a class="link" href="#sets">Sets</a></h5>
<div class="paragraph">
<p>And finally, <strong>Sets</strong>.</p>
</div>
<div class="paragraph">
<p>Sets store zero or more unique items of any type and are unordered. They,
like maps, use curly braces for their literal syntax, with the difference being that they use a <code>#</code> as leading
character:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-ss">:foo</span> <span class="tok-ss">:bar</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In subsequent chapters we&#8217;ll go in depth about sets and the other collection types you&#8217;ve seen in this
chapter.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="vars"><a class="link" href="#vars">2.3. Vars</a></h3>
<div class="paragraph">
<p><em>ClojureScript</em> is a mostly functional language and focused on immutability. Because of that, it does
not have the concept of variables as you know them in most other programming languages. The closest analogy to
variables are the variables you define in algebra; when you say <code>x = 6</code> in mathematics, you are saying that you
want the symbol <code>x</code> to stand for the number six.</p>
</div>
<div class="paragraph">
<p>In <em>ClojureScript</em>, vars are represented by symbols and store a single value together with metadata.</p>
</div>
<div class="paragraph">
<p>You can define a var using a <code>def</code> special form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">x</span> <span class="tok-mi">22</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Vars are always top level in the namespace (which we will explain later). If you use <code>def</code> in a function call,
the var will be defined at the namespace level, but we do not recommend this - instead, you should use <code>let</code>
to define variables within a function.</p>
</div>
</div>
<div class="sect2">
<h3 id="functions"><a class="link" href="#functions">2.4. Functions</a></h3>
<div class="sect3">
<h4 id="the-first-contact"><a class="link" href="#the-first-contact">2.4.1. The first contact</a></h4>
<div class="paragraph">
<p>It&#8217;s time to make things happen. <em>ClojureScript</em>, has what are known as first class functions. They behave
like any other type, you can pass them as parameters and you can return them as values, always respecting
the lexical scope. <em>ClojureScript</em> also has some features of dynamic scoping, but this will be discussed
in other section.</p>
</div>
<div class="paragraph">
<p>If you want know more about scopes, this <a href="http://en.wikipedia.org/wiki/Scope_(computer_science)">wikipedia article</a>
is very extensive and explains different types of scoping.</p>
</div>
<div class="paragraph">
<p>As <em>ClojureScript</em> is a Lisp dialect, it uses the prefix notation for calling a function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">inc </span><span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, <code>inc</code> is a function and is part of the <em>ClojureScript</em> runtime, and <code>1</code> is the first
argument for the <code>inc</code> function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>+</code> symbol represents an <code>add</code> function. It allows multiple parameters, whereas in ALGOL-type languages,
<code>+</code> is an operator and only allows two parameters.</p>
</div>
<div class="paragraph">
<p>The prefix notation has huge advantages, some of them not always obvious. <em>ClojureScript</em> does not
make a distinction between a function and operator; everything is a function. The immediate advantage
is that the prefix notation allows an arbitrary number of arguments per "operator". Also, it completely
eliminates the problem of operator precedence.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining-your-own-functions"><a class="link" href="#defining-your-own-functions">2.4.2. Defining your own functions</a></h4>
<div class="paragraph">
<p>You can define an un-named (anonymous) function with the <code>fn</code> special form. This is one type of function definition;
in the following example, the function takes two parameters and returns their average.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">fn </span><span class="tok-p">[</span><span class="tok-nv">param1</span> <span class="tok-nv">param2</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">/ </span><span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">param1</span> <span class="tok-nv">param2</span><span class="tok-p">)</span> <span class="tok-mf">2.0</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define a function and call it at same time (in a single expression):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">((</span><span class="tok-k">fn </span><span class="tok-p">[</span><span class="tok-nv">x</span><span class="tok-p">]</span> <span class="tok-p">(</span><span class="tok-nb">* </span><span class="tok-nv">x</span> <span class="tok-nv">x</span><span class="tok-p">))</span> <span class="tok-mi">5</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 25</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s start creating named functions. But what does a <em>named function</em> really mean? It is very simple;
as in <em>ClojureScript</em>, functions are first-class and behave like any other value, so naming a function
is done by simply binding the function to a symbol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">square</span> <span class="tok-p">(</span><span class="tok-k">fn </span><span class="tok-p">[</span><span class="tok-nv">x</span><span class="tok-p">]</span> <span class="tok-p">(</span><span class="tok-nb">* </span><span class="tok-nv">x</span> <span class="tok-nv">x</span><span class="tok-p">)))</span>

<span class="tok-p">(</span><span class="tok-nf">square</span> <span class="tok-mi">12</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 144</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>ClojureScript</em> also offers the <code>defn</code> macro as a little syntactic sugar for making function definition
more idiomatic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">square</span>
  <span class="tok-s">&quot;Return the square of a given number.&quot;</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">* </span><span class="tok-nv">x</span> <span class="tok-nv">x</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The string that comes between the function name and the parameter vector is called a
<em>docstring</em> (documentation string); programs that automatically create web documentation
from your source files will use these docstrings.</p>
</div>
</div>
<div class="sect3">
<h4 id="function-with-multiple-arities"><a class="link" href="#function-with-multiple-arities">2.4.3. Function with multiple arities</a></h4>
<div class="paragraph">
<p><em>ClojureScript</em> also comes with the ability to define functions with arbitrary number of
arguments. (The term <em>arity</em> means the number of arguments that a function takes.) The
syntax is almost the same as for defining an ordinary function, with the difference that
it has more than one body.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example, which will surely explain it much better:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">myinc</span>
  <span class="tok-s">&quot;Self defined version of parameterized `inc`.&quot;</span>
  <span class="tok-p">([</span><span class="tok-nv">x</span><span class="tok-p">]</span> <span class="tok-p">(</span><span class="tok-nf">myinc</span> <span class="tok-nv">x</span> <span class="tok-mi">1</span><span class="tok-p">))</span>
  <span class="tok-p">([</span><span class="tok-nv">x</span> <span class="tok-nv">increment</span><span class="tok-p">]</span>
   <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-nv">increment</span><span class="tok-p">)))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This line: <code>([x] (myinc x 1)</code> says that if there is only one argument, call the function
<code>myinc</code> with that argument and the number <code>1</code> as the second argument. The other function body:
<code>([x increment] (+ x increment))</code> says that if there are two arguments, return the result of
adding them.</p>
</div>
<div class="paragraph">
<p>Here are some examples using the previously defined multi-arity function. Observe that
if you call a function with wrong number of arguments, the compiler will emit an error message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">myinc</span> <span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 1</span>

<span class="tok-p">(</span><span class="tok-nf">myinc</span> <span class="tok-mi">1</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 4</span>

<span class="tok-p">(</span><span class="tok-nf">myinc</span> <span class="tok-mi">1</span> <span class="tok-mi">3</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; Compiler error</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Explaining the concept of "arity" is out of the scope of this book, however you can read about that in this
<a href="http://en.wikipedia.org/wiki/Arity">wikipedia article</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="variadic-functions"><a class="link" href="#variadic-functions">2.4.4. Variadic functions</a></h4>
<div class="paragraph">
<p>Another way to accept multiple parameters is defining variadic functions. Variadic functions
are functions that will be able to accept an arbitrary number of arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">my-variadic-set</span>
  <span class="tok-p">[</span><span class="tok-o">&amp;</span> <span class="tok-nv">params</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">set </span><span class="tok-nv">params</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">my-variadic-set</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{1 2 3}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The way to denote a variadic function is using the <code>&amp;</code> symbol prefix on its arguments vector.</p>
</div>
</div>
<div class="sect3">
<h4 id="short-syntax-for-anonymous-functions"><a class="link" href="#short-syntax-for-anonymous-functions">2.4.5. Short syntax for anonymous functions</a></h4>
<div class="paragraph">
<p><em>ClojureScript</em> provides a shorter syntax for defining anonymous functions using
the <code>#()</code> reader macro (usually leads to one liners). Reader macros are "special" expressions that will be
transformed to the appropriate language form at compile time; in this case, to some expression
that uses <code>fn</code> special form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">my-set</span> <span class="tok-o">#</span><span class="tok-p">(</span><span class="tok-nb">set </span><span class="tok-p">(</span><span class="tok-nb">list </span><span class="tok-nv">%1</span> <span class="tok-nv">%2</span><span class="tok-p">)))</span>

<span class="tok-p">(</span><span class="tok-nf">my-set</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{1 2}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding definition is shorthand for:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">my-set-longer</span> <span class="tok-p">(</span><span class="tok-k">fn </span><span class="tok-p">[</span><span class="tok-nv">a</span> <span class="tok-nv">b</span><span class="tok-p">]</span> <span class="tok-o">#</span><span class="tok-p">(</span><span class="tok-nb">set </span><span class="tok-p">(</span><span class="tok-nb">list </span><span class="tok-nv">a</span> <span class="tok-nv">b</span><span class="tok-p">))))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>%1</code>, <code>%2</code>, <code>%N</code> are simple markers for parameter positions that are implicitly declared when
the reader macro will be interpreted and converted to a <code>fn</code> expression.</p>
</div>
<div class="paragraph">
<p>Also, if a function only accepts one argument, you can omit the number after <code>%</code> symbol; the
function <code>#(set (list %1))</code> can be written <code>#(set (list %))</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, this syntax also supports the variadic form with the`%&amp;` symbol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">my-variadic-set</span> <span class="tok-o">#</span><span class="tok-p">(</span><span class="tok-nb">set </span><span class="tok-nv">%</span><span class="tok-o">&amp;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">my-variadic-set</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{1 2}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="flow-control"><a class="link" href="#flow-control">2.5. Flow control</a></h3>
<div class="paragraph">
<p><em>ClojureScript</em> has a very different approach for flow control than languages like JavaScript, C, etc.</p>
</div>
<div class="sect3">
<h4 id="branching-with-code-if-code"><a class="link" href="#branching-with-code-if-code">2.5.1. Branching with <code>if</code></a></h4>
<div class="paragraph">
<p>Let start with a basic one: <code>if</code>. In <em>ClojureScript</em> the <code>if</code> is an expression and not a
statement, and it has three parameter: the first one is the condition expression, the second one
is an expression that will be evaluated if the condition expression evaluates to logical true,
and the third expression will be evaluated otherwise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">discount</span>
  <span class="tok-s">&quot;You get 5% discount for ordering 100 or more items&quot;</span>
  <span class="tok-p">[</span><span class="tok-nv">quantity</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-k">if </span><span class="tok-p">(</span><span class="tok-nb">&gt;= </span><span class="tok-nv">quantity</span> <span class="tok-mi">100</span><span class="tok-p">)</span>
    <span class="tok-mf">0.05</span>
    <span class="tok-mi">0</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">discount</span> <span class="tok-mi">30</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 0</span>

<span class="tok-p">(</span><span class="tok-nf">discount</span> <span class="tok-mi">130</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 0.05</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The block expression <code>do</code> can be used to have multiple expressions in an <code>if</code> branch.
<code>do</code> is explained in the next section.</p>
</div>
</div>
<div class="sect3">
<h4 id="branching-with-code-cond-code"><a class="link" href="#branching-with-code-cond-code">2.5.2. Branching with <code>cond</code></a></h4>
<div class="paragraph">
<p>Sometimes, the <code>if</code> expression can be slightly limited because it does not have the "else if" part
to add more than one condition. The <code>cond</code> comes to the rescue.</p>
</div>
<div class="paragraph">
<p>With the <code>cond</code> expression, you can define multiple conditions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">mypos?</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nf">cond</span>
    <span class="tok-p">(</span><span class="tok-nb">&gt; </span><span class="tok-nv">x</span> <span class="tok-mi">0</span><span class="tok-p">)</span> <span class="tok-s">&quot;positive&quot;</span>
    <span class="tok-p">(</span><span class="tok-nb">&lt; </span><span class="tok-nv">x</span> <span class="tok-mi">0</span><span class="tok-p">)</span> <span class="tok-s">&quot;negative&quot;</span>
    <span class="tok-ss">:else</span> <span class="tok-s">&quot;zero&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">mypos?</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;zero&quot;</span>

<span class="tok-p">(</span><span class="tok-nf">mypos?</span> <span class="tok-mi">-2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;negative&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, <code>cond</code> has another form, called <code>condp</code>, that works very similarly to the simple <code>cond</code>
but looks cleaner when the condition (also called a predicate) is the same for all conditions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">translate-lang-code</span>
  <span class="tok-p">[</span><span class="tok-nv">code</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nf">condp</span> <span class="tok-nb">= </span><span class="tok-p">(</span><span class="tok-nb">keyword </span><span class="tok-nv">code</span><span class="tok-p">)</span>
    <span class="tok-ss">:es</span> <span class="tok-s">&quot;Spanish&quot;</span>
    <span class="tok-ss">:en</span> <span class="tok-s">&quot;English&quot;</span>
    <span class="tok-s">&quot;Unknown&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">translate-lang-code</span> <span class="tok-s">&quot;en&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;English&quot;</span>

<span class="tok-p">(</span><span class="tok-nf">translate-lang-code</span> <span class="tok-s">&quot;fr&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Unknown&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The line <code>condp = (keyword code)</code> means that, in each of the following lines, <em>ClojureScript</em>
will apply the <code>=</code> function to the given keyword and the <code>code</code> argument.</p>
</div>
</div>
<div class="sect3">
<h4 id="branching-with-code-case-code"><a class="link" href="#branching-with-code-case-code">2.5.3. Branching with <code>case</code></a></h4>
<div class="paragraph">
<p>The <code>case</code> branching expression has very similar use case as our previous example with
<code>condp</code>. The main difference is that <code>case</code> always uses the <code>=</code> predicate/function, and its
branching values are evaluated at compile time. This results in a more performant form
than <code>cond</code> or <code>condp</code> but has the disadvantage that the condition value must be
a static value.</p>
</div>
<div class="paragraph">
<p>Here is the same example as previous one, but using <code>case</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">translate-lang-code</span>
  <span class="tok-p">[</span><span class="tok-nv">code</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nf">case</span> <span class="tok-nv">code</span>
    <span class="tok-s">&quot;es&quot;</span> <span class="tok-s">&quot;Spanish&quot;</span>
    <span class="tok-s">&quot;es&quot;</span> <span class="tok-s">&quot;English&quot;</span>
    <span class="tok-s">&quot;Unknown&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">translate-lang-code</span> <span class="tok-s">&quot;en&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;English&quot;</span>

<span class="tok-p">(</span><span class="tok-nf">translate-lang-code</span> <span class="tok-s">&quot;fr&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Unknown&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="locals-blocks-and-loops"><a class="link" href="#locals-blocks-and-loops">2.6. Locals, Blocks and Loops</a></h3>
<div class="sect3">
<h4 id="locals"><a class="link" href="#locals">2.6.1. Locals</a></h4>
<div class="paragraph">
<p><em>ClojureScript</em> does not has the concept of variables as in ALGOL-like languages, but it does
have locals. Locals, as per usual, are immutable, and if you try mutate them, the compiler
will throw an error.</p>
</div>
<div class="paragraph">
<p>The locals are defined with the <code>let</code> expression. The expression starts with a vector as first parameter
followed by arbitrary number of expressions. The first parameter (the vector) should contain an arbitrary
number of pairs that give a <em>binding form</em> (usually a symbol) followed by an expression whose value will
be bound to this new local for the remainder of the let expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">(</span><span class="tok-nb">inc </span><span class="tok-mi">1</span><span class="tok-p">)</span>
      <span class="tok-nv">y</span> <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-mi">1</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Simple message from the body of a let&quot;</span><span class="tok-p">)</span>
  <span class="tok-p">(</span><span class="tok-nb">* </span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">))</span>
<span class="tok-c1">;; Simple message from the body of a let</span>
<span class="tok-c1">;; =&gt; 6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, the symbol <code>x</code> is bound to the value <code>(inc 1)</code>, which comes out to 2,
and the symbol <code>y</code> is bound to the sum of <code>x</code> and 1, which comes out to 3. Given those bindings, the
expressions <code>(println "Simple message from the body of a let")</code> and <code>(* x y)</code> are evaluated.</p>
</div>
</div>
<div class="sect3">
<h4 id="blocks"><a class="link" href="#blocks">2.6.2. Blocks</a></h4>
<div class="paragraph">
<p>In JavaScript, braces <code>{</code> and <code>}</code> delimit a block of code that “belongs together.” Blocks in
<em>ClojureScript</em> are created using the <code>do</code> expression and are usually used for side effects, like
printing something to the console or writing a log in a logger.</p>
</div>
<div class="paragraph">
<p>A side effect is something that is not necessary for the return value.</p>
</div>
<div class="paragraph">
<p>The <code>do</code> expression accepts as its parameter an arbitrary number of other expressions, but it returns
the return value only from the last one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">do</span>
   <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;hello world&quot;</span><span class="tok-p">)</span>
   <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;hola mundo&quot;</span><span class="tok-p">)</span>
   <span class="tok-p">(</span><span class="tok-nb">* </span><span class="tok-mi">3</span> <span class="tok-mi">5</span><span class="tok-p">)</span> <span class="tok-c1">;; this value will not be returned; it is thrown away</span>
   <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">))</span>

<span class="tok-c1">;; hello world</span>
<span class="tok-c1">;; hola mundo</span>
<span class="tok-c1">;; =&gt; 3</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The body of the <code>let</code> expression, explained in previous section, is very similar to the
<code>do</code> expression, in that it allows multiple expressions. In fact, the <code>let</code> has an implicit <code>do</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="loops"><a class="link" href="#loops">2.6.3. Loops</a></h4>
<div class="paragraph">
<p>The functional approach of <em>ClojureScript</em> means that it does not have standard,
well known statement-based loops such as <code>for</code> in JavaScript. The loops in <em>ClojureScript</em> are handled using recursion.
Recursion sometimes requires additional thinking about how to model your problem in
a slightly different way than imperative languages.</p>
</div>
<div class="paragraph">
<p>Also, many of the common patterns for which <code>for</code> is used in other languages are achieved
through higher-order functions - functions that accept other functions as parameters.</p>
</div>
<div class="sect4">
<h5 id="looping-with-loop-recur"><a class="link" href="#looping-with-loop-recur">Looping with loop/recur</a></h5>
<div class="paragraph">
<p>Let&#8217;s take a look at how to express loops using recursion with the <code>loop</code> and <code>recur</code> forms.
<code>loop</code> defines a possibly empty list of bindings (notice the symmetry with <code>let</code>) and <code>recur</code>
jumps execution back to the looping point with new values for those bindings.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">loop </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-mi">0</span><span class="tok-p">]</span>
   <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Looping with &quot;</span> <span class="tok-nv">x</span><span class="tok-p">)</span>
   <span class="tok-p">(</span><span class="tok-k">if </span><span class="tok-p">(</span><span class="tok-nb">= </span><span class="tok-nv">x</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
     <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Done looping!&quot;</span><span class="tok-p">)</span>
     <span class="tok-p">(</span><span class="tok-nf">recur</span> <span class="tok-p">(</span><span class="tok-nb">inc </span><span class="tok-nv">x</span><span class="tok-p">))))</span>
<span class="tok-c1">;; Looping with 0</span>
<span class="tok-c1">;; Looping with 1</span>
<span class="tok-c1">;; Looping with 2</span>
<span class="tok-c1">;; Done looping!</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above snippet, we bind the name <code>x</code> to the value <code>0</code> and execute the body. Since the
condition is not met the first time it&#8217;s run we <code>recur</code>, incrementing the binding value with
the <code>inc</code> function. We do this once more until the condition is met and, since there aren&#8217;t
more <code>recur</code> calls, exit the loop.</p>
</div>
<div class="paragraph">
<p>Note that <code>loop</code> isn&#8217;t the only point we can <code>recur</code> to; using <code>recur</code> inside a function
executes the body of the function recursively with the new bindings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">recursive-function</span> <span class="tok-p">[</span><span class="tok-nv">x</span><span class="tok-p">]</span>
   <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Looping with&quot;</span> <span class="tok-nv">x</span><span class="tok-p">)</span>
   <span class="tok-p">(</span><span class="tok-k">if </span><span class="tok-p">(</span><span class="tok-nb">= </span><span class="tok-nv">x</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
     <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Done looping!&quot;</span><span class="tok-p">)</span>
     <span class="tok-p">(</span><span class="tok-nf">recur</span> <span class="tok-p">(</span><span class="tok-nb">inc </span><span class="tok-nv">x</span><span class="tok-p">))))</span>

<span class="tok-p">(</span><span class="tok-nf">recursive-function</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; Looping with 0</span>
<span class="tok-c1">;; Looping with 1</span>
<span class="tok-c1">;; Looping with 2</span>
<span class="tok-c1">;; Done looping!</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="replacing-for-loops-with-higher-order-functions"><a class="link" href="#replacing-for-loops-with-higher-order-functions">Replacing for loops with higher-order functions</a></h5>
<div class="paragraph">
<p>In imperative programming languages it is common to use <code>for</code> loops to iterate over data and
transform it, usually the intent being one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Transform every value in the iterable yielding another iterable</p>
</li>
<li>
<p>Filter the elements of the iterable by certain criteria</p>
</li>
<li>
<p>Convert the iterable to a value where each iteration depends on the result from the previous one</p>
</li>
<li>
<p>Run a computation for every value in the iterable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The above actions are encoded in higher-order functions and syntactic constructs in ClojureScript;
let&#8217;s see an example of the first three.</p>
</div>
<div class="paragraph">
<p>For transforming every value in an iterable data structure we use the <code>map</code> function, which takes a
function and a sequence and applies the function to every element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">map inc </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (1 2 3)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For filtering the values of a data structure we use the <code>filter</code> function, which takes a predicate
and a sequence and gives a new sequence with only the elements that returned <code>true</code> for the given
predicate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">filter </span><span class="tok-nv">odd?</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (1 3)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Converting an iterable to a single value, accumulating the intermediate result at every step of the iteration
can be achieved with <code>reduce</code>, which takes a function for accumulating values, an optional initial value
and a collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">reduce + </span><span class="tok-mi">0</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; 10</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="code-for-code-sequence-comprehensions"><a class="link" href="#code-for-code-sequence-comprehensions"><code>for</code> sequence comprehensions</a></h5>
<div class="paragraph">
<p>In ClojureScript the <code>for</code> construct isn&#8217;t used for iteration but for generating sequences, an operation
also known as "sequence comprehension". It offers a small domain specific language for declaratively
building sequences.</p>
</div>
<div class="paragraph">
<p><code>for</code> takes a vector of bindings and a expression and generates a sequence of the result of evaluating the
expression. Let&#8217;s take a look at an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">for </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]]</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-nv">x</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; ([1 1] [2 2] [3 3])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>x</code> is bound to each of the items in the vector <code>[1 2 3]</code> in turn, and returns a new
sequence of two-item vectors with the original item repeated.</p>
</div>
<div class="paragraph">
<p><code>for</code> supports multiple bindings, which will cause the collections to be iterated in a nested fashion, much
like nesting <code>for</code> loops in imperative languages. The innermost binding iterates “fastest.”</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">for </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
      <span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">]]</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">])</span>

<span class="tok-c1">;; =&gt; ([1 4] [1 5] [2 4] [2 5] [3 4] [3 5])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also follow the bindings with three modifiers: <code>:let</code> for creating local bindings, <code>:while</code> for
breaking out of the sequence generation, and <code>:when</code> for filtering out values.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of local bindings using the <code>:let</code> modifier; note that the bindings defined with it
will be available in the expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">for </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
      <span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">]</span>
      <span class="tok-ss">:let</span> <span class="tok-p">[</span><span class="tok-nv">z</span> <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">)]]</span>
  <span class="tok-nv">z</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (5 6 6 7 7 8)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use the <code>:while</code> modifier for expressing a condition that, when it is no longer met, will stop
the sequence generation. Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">for </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
      <span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">]</span>
      <span class="tok-ss">:while</span> <span class="tok-p">(</span><span class="tok-nb">= </span><span class="tok-nv">y</span> <span class="tok-mi">4</span><span class="tok-p">)]</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">])</span>

<span class="tok-c1">;; =&gt; ([1 4] [2 4] [3 4])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For filtering out generated values, use the <code>:when</code> modifier as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">for </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
      <span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">]</span>
      <span class="tok-ss">:when</span> <span class="tok-p">(</span><span class="tok-nb">= </span><span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">)</span> <span class="tok-mi">6</span><span class="tok-p">)]</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">])</span>

<span class="tok-c1">;; =&gt; ([1 5] [2 4])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can combine the modifiers shown above for expressing complex sequence generations or
more clearly expressing the intent of our comprehension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">for </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
      <span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">]</span>
      <span class="tok-ss">:let</span> <span class="tok-p">[</span><span class="tok-nv">z</span> <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">)]</span>
      <span class="tok-ss">:when</span> <span class="tok-p">(</span><span class="tok-nb">= </span><span class="tok-nv">z</span> <span class="tok-mi">6</span><span class="tok-p">)]</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">])</span>

<span class="tok-c1">;; =&gt; ([1 5] [2 4])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When we outlined the most common usages of the <code>for</code> construct in imperative programming languages,
we mentioned that sometimes we want to run a computation for every value in a sequence, not caring
about the result. Presumably we do this for achieving some sort of side-effect with the values of
the sequence.</p>
</div>
<div class="paragraph">
<p>ClojureScript provides the <code>doseq</code> construct, which is analogous to <code>for</code> but executes the expression,
discards the resulting values, and returns <code>nil</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">doseq </span><span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
        <span class="tok-nv">y</span> <span class="tok-p">[</span><span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">]</span>
       <span class="tok-ss">:let</span> <span class="tok-p">[</span><span class="tok-nv">z</span> <span class="tok-p">(</span><span class="tok-nb">+ </span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">)]]</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-nv">x</span> <span class="tok-s">&quot;+&quot;</span> <span class="tok-nv">y</span> <span class="tok-s">&quot;=&quot;</span> <span class="tok-nv">z</span><span class="tok-p">))</span>

<span class="tok-c1">;; 1 + 4 = 5</span>
<span class="tok-c1">;; 1 + 5 = 6</span>
<span class="tok-c1">;; 2 + 4 = 6</span>
<span class="tok-c1">;; 2 + 5 = 7</span>
<span class="tok-c1">;; 3 + 4 = 7</span>
<span class="tok-c1">;; 3 + 5 = 8</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="collection-types"><a class="link" href="#collection-types">2.7. Collection types</a></h3>
<div class="sect3">
<h4 id="immutable-and-persistent"><a class="link" href="#immutable-and-persistent">2.7.1. Immutable and persistent</a></h4>
<div class="paragraph">
<p>We mentioned before that ClojureScript collections are persistent and immutable, but we didn&#8217;t explain what
that meant.</p>
</div>
<div class="paragraph">
<p>An immutable data structure, as its name suggest, is a data structure that can not be changed. In-place
updates are not allowed in immutable data structures.</p>
</div>
<div class="paragraph">
<p>A persistent data structure is a data structure that returns a new version of itself when transforming
it, leaving the original unmodified. ClojureScript makes this memory and time efficient using an
implementation technique called <em>structural sharing</em>, where most of the data shared between two versions
of a value is not duplicated, and transformations of a value are implemented by copying the minimal amount of data
required.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example of appending values to a vector using the <code>conj</code> (for "conjoin") operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">xs</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">]</span>
      <span class="tok-nv">ys</span> <span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">xs</span> <span class="tok-mi">4</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;xs:&quot;</span> <span class="tok-nv">xs</span><span class="tok-p">)</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;ys:&quot;</span> <span class="tok-nv">ys</span><span class="tok-p">))</span>

<span class="tok-c1">;; xs: [1 2 3]</span>
<span class="tok-c1">;; ys: [1 2 3 4]</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, we derived a new version of the <code>xs</code> vector appending an element to it and got a new
vector <code>ys</code> with the element added. However, the <code>xs</code> vector remained unchanged, because it is immutable.</p>
</div>
<div class="paragraph">
<p>For illustrating the structural sharing of ClojureScript data structures, let&#8217;s compare whether some parts
of the old and new versions of a data structure are actually the same object with the <code>identical?</code> predicate.
We&#8217;ll use the list data type for this purpose:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">xs</span> <span class="tok-p">(</span><span class="tok-nb">list </span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
      <span class="tok-nv">ys</span> <span class="tok-p">(</span><span class="tok-nb">cons </span><span class="tok-mi">0</span> <span class="tok-nv">xs</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;xs:&quot;</span> <span class="tok-nv">xs</span><span class="tok-p">)</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;ys:&quot;</span> <span class="tok-nv">ys</span><span class="tok-p">)</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;(rest ys):&quot;</span> <span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-nv">ys</span><span class="tok-p">))</span>
  <span class="tok-p">(</span><span class="tok-nb">identical? </span><span class="tok-nv">xs</span> <span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-nv">ys</span><span class="tok-p">)))</span>

<span class="tok-c1">;; xs: (1 2 3)</span>
<span class="tok-c1">;; ys: (0 1 2 3)</span>
<span class="tok-c1">;; (rest ys): (1 2 3)</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the example, we used <code>cons</code> (construct) to prepend a value to the <code>xs</code> list and we got
a new list <code>ys</code> with the element added. The <code>rest</code> of the <code>ys</code> list (all the values but the first)
are the same object in memory as the <code>xs</code> list, thus <code>xs</code> and <code>ys</code> share structure.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-sequence-abstraction"><a class="link" href="#the-sequence-abstraction">2.7.2. The sequence abstraction</a></h4>
<div class="paragraph">
<p>One of the central ClojureScript abstractions is the Sequence, which can be thought of as a list and can be derived
from any of the collection types. It is persistent and immutable like all collection types, and many of the
core ClojureScript functions return sequences.</p>
</div>
<div class="paragraph">
<p>The types that can be used to generate a sequence are called "seqables"; we can call <code>seq</code> on them and get
a sequence back. Sequences support two basic operations: <code>first</code> and <code>rest</code>. They both call <code>seq</code> on the
argument we provide them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">first </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; 1</span>

<span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (2 3)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Calling <code>seq</code> on a seqable can yield different results if the seqable is empty or not. It will return <code>nil</code>
when empty and a sequence otherwise:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">seq </span><span class="tok-p">[])</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nb">seq </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (1 2 3)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>next</code> is a similar sequence operation to <code>rest</code>, but it differs from the latter in that it yields a <code>nil</code> value
when called with a sequence with one or zero elements. Note that, when given one of the aforementioned sequences,
the empty sequence returned by <code>rest</code> will evaluate as a boolean true whereas the <code>nil</code> value returned by <code>next</code>
will evaluate as false (see the section on <em>truthiness</em> later in this chapter).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-p">[])</span>
<span class="tok-c1">;; =&gt; ()</span>

<span class="tok-p">(</span><span class="tok-nb">next </span><span class="tok-p">[])</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (2 3)</span>

<span class="tok-p">(</span><span class="tok-nb">next </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (2 3)</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="nil-punning"><a class="link" href="#nil-punning">nil-punning</a></h5>
<div class="paragraph">
<p>The above behaviour of <code>seq</code> when coupled with the falsey nature of <code>nil</code> in boolean contexts make it an idiom for checking
the emptyness of a sequence in ClojureScript, which is often referred to as nil-punning.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">print-coll</span>
  <span class="tok-p">[</span><span class="tok-nv">coll</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">when </span><span class="tok-p">(</span><span class="tok-nb">seq </span><span class="tok-nv">coll</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Saw &quot;</span> <span class="tok-p">(</span><span class="tok-nb">first </span><span class="tok-nv">coll</span><span class="tok-p">))</span>
    <span class="tok-p">(</span><span class="tok-nf">recur</span> <span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-nv">coll</span><span class="tok-p">))))</span>

<span class="tok-p">(</span><span class="tok-nf">print-coll</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; Saw 1</span>
<span class="tok-c1">;; Saw 2</span>
<span class="tok-c1">;; Saw 3</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nf">print-coll</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">})</span>
<span class="tok-c1">;; Saw 1</span>
<span class="tok-c1">;; Saw 3</span>
<span class="tok-c1">;; Saw 2</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>nil</code> is also both a seqable and a sequence, and thus it supports all the functions we saw so far:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">seq </span><span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nb">first </span><span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nb">rest </span><span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; ()</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="functions-that-work-on-sequences"><a class="link" href="#functions-that-work-on-sequences">Functions that work on sequences</a></h5>
<div class="paragraph">
<p>The ClojureScript core functions that work on collections call <code>seq</code> on their arguments, thus being
implemented in terms of generic sequence operations. This also makes them short-circuit when encountering empty
collections and makes them <code>nil</code>-safe.</p>
</div>
<div class="paragraph">
<p>We already saw examples with the usual suspects like <code>map</code>, <code>filter</code> and <code>reduce</code>, but ClojureScript offers a
plethora of generic sequence operations in its core namespace. Note that many of the operations we&#8217;ll learn about
either work with seqables or are extensible to user defined types.</p>
</div>
<div class="paragraph">
<p>We can query a value to know whether it&#8217;s a collection type with the <code>coll?</code> predicate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">coll?</span> <span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span>

<span class="tok-p">(</span><span class="tok-nf">coll?</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nf">coll?</span> <span class="tok-p">{</span><span class="tok-ss">:language</span> <span class="tok-s">&quot;ClojureScript&quot;</span> <span class="tok-ss">:file-extension</span> <span class="tok-s">&quot;cljs&quot;</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nf">coll?</span> <span class="tok-s">&quot;ClojureScript&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Similar predicates exist for checking if a value is sequence (<code>seq?</code>) or a seqable (<code>seqable?</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">seq? </span><span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span>
<span class="tok-p">(</span><span class="tok-nf">seqable?</span> <span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span>

<span class="tok-p">(</span><span class="tok-nb">seq? </span><span class="tok-p">[])</span>
<span class="tok-c1">;; =&gt; false</span>
<span class="tok-p">(</span><span class="tok-nf">seqable?</span> <span class="tok-p">[])</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nb">seq? </span><span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; false</span>
<span class="tok-p">(</span><span class="tok-nf">seqable?</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nb">seq? </span><span class="tok-s">&quot;ClojureScript&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span>
<span class="tok-p">(</span><span class="tok-nf">seqable?</span> <span class="tok-s">&quot;ClojureScript&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For collections that can be counted in constant time, we can use the <code>count</code> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">count </span><span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 0</span>

<span class="tok-p">(</span><span class="tok-nb">count </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; 3</span>

<span class="tok-p">(</span><span class="tok-nb">count </span><span class="tok-p">{</span><span class="tok-ss">:language</span> <span class="tok-s">&quot;ClojureScript&quot;</span> <span class="tok-ss">:file-extension</span> <span class="tok-s">&quot;cljs&quot;</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; 2</span>

<span class="tok-p">(</span><span class="tok-nb">count </span><span class="tok-s">&quot;ClojureScript&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 13</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also get an empty variant of a given collection with the <code>empty</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">empty</span> <span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nf">empty</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; []</span>

<span class="tok-p">(</span><span class="tok-nf">empty</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; #{}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>empty?</code> predicate returns true if the given collection is empty:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">empty?</span> <span class="tok-nv">nil</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nf">empty?</span> <span class="tok-p">[])</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nf">empty?</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>conj</code> operation adds elements to collections and may add them in different "places" depending
on the collection. It adds them where it is most performant for the collection type,
but note that not every collection has a defined order.</p>
</div>
<div class="paragraph">
<p>We can pass as many elements we want to add to <code>conj</code>; let&#8217;s see it in action:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">nil</span> <span class="tok-mi">42</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (42)</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">]</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [1 2 3]</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">]</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [1 2 3 4 5]</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (0 1 2)</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">}</span> <span class="tok-mi">4</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{1 3 2 4}</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-p">{</span><span class="tok-ss">:language</span> <span class="tok-s">&quot;ClojureScript&quot;</span><span class="tok-p">}</span> <span class="tok-p">[</span><span class="tok-ss">:file-extension</span> <span class="tok-s">&quot;cljs&quot;</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; {:language &quot;ClojureScript&quot;, :file-extension &quot;cljs&quot;}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="laziness"><a class="link" href="#laziness">Laziness</a></h5>
<div class="paragraph">
<p>Most of ClojureScript&#8217;s sequence-returning functions generate lazy sequences instead of eagerly creating
a whole new sequence. Lazy sequences generate their contents as they are requested, usually when iterating
over them. Laziness ensures that we don&#8217;t do more work than we need to and gives us the possibility of
treating potentially infinite sequences as regular ones.</p>
</div>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="collections-in-depth"><a class="link" href="#collections-in-depth">2.7.3. Collections in depth</a></h4>
<div class="paragraph">
<p>Now that we&#8217;re acquainted with ClojureScript&#8217;s sequence abstraction and some of the generic sequence manipulating
functions, it&#8217;s time to dive into the concrete collection types and the operations they support.</p>
</div>
<div class="sect4">
<h5 id="lists-2"><a class="link" href="#lists-2">Lists</a></h5>
<div class="paragraph">
<p>In ClojureScript lists are mostly used as a data structure for grouping symbols together into programs. Unlike in other
Lisps, many of the syntactic constructs of ClojureScript use data structures different from the list (vectors and maps).
This makes code less uniform, but the gains in readability are well worth the price.</p>
</div>
<div class="paragraph">
<p>You can think of ClojureScript lists as singly linked lists, where each node contains a value and a pointer to the rest of the list.
This makes natural (and fast!) to add items to the front of the list since adding to the end would require traversal of the entire
list. The prepend operation is performed using the <code>cons</code> (construct) function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">cons </span><span class="tok-mi">0</span> <span class="tok-p">(</span><span class="tok-nb">cons </span><span class="tok-mi">1</span> <span class="tok-p">(</span><span class="tok-nb">cons </span><span class="tok-mi">2</span> <span class="tok-p">())))</span>
<span class="tok-c1">;; =&gt; (0 1 2)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We used the literal <code>()</code> to represent the empty list. Since it doesn&#8217;t contain any symbols, it is not treated
as a function call. However, when using list literals that contain elements, we need to quote them to
prevent ClojureScript from evaluating them as a function call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">cons </span><span class="tok-mi">0</span> <span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; (0 1 2)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the head is the position that has constant time addition in the list collection, the <code>conj</code> operation
on lists naturally adds item in the front:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">)</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (0 1 2)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lists and other ClojureScript data structures can be used as stacks using the <code>peek</code>, <code>pop</code>, and <code>conj</code> functions.
Note that the top of the stack will be the "place" where <code>conj</code> adds elements to, making <code>conj</code> equivalent to the
stack&#8217;s push operation. In the case of lists, <code>conj</code> adds elements to the front of the list, <code>peek</code> returns the first
element of the list, and <code>pop</code> returns a list with all the elements but the first one.</p>
</div>
<div class="paragraph">
<p>Note that the two operations that return a stack (<code>conj</code> and <code>pop</code>) don&#8217;t change the type of the collection used for
the stack.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">list-stack</span> <span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nb">peek </span><span class="tok-nv">list-stack</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 0</span>

<span class="tok-p">(</span><span class="tok-nb">pop </span><span class="tok-nv">list-stack</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (1 2)</span>

<span class="tok-p">(</span><span class="tok-nf">type</span> <span class="tok-p">(</span><span class="tok-nb">pop </span><span class="tok-nv">list-stack</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; cljs.core/List</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">list-stack</span> <span class="tok-mi">-1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (-1 0 1 2)</span>

<span class="tok-p">(</span><span class="tok-nf">type</span> <span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">list-stack</span> <span class="tok-mi">-1</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; cljs.core/List</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>One thing that lists are not particularly good at is random indexed access. Since they are stored in a single linked list-like
structure in memory, random access to a given index requires a linear traversal in order to either retrieve the requested
item or throw an index out of bounds error. Non-indexed ordered collections like lazy sequences also suffer from this limitation.</p>
</div>
</div>
<div class="sect4">
<h5 id="vectors-2"><a class="link" href="#vectors-2">Vectors</a></h5>
<div class="paragraph">
<p>Vectors are one of the most common data structures in ClojureScript. They are used as a syntactic construct in many
places where more traditional Lisps use lists, for example in function argument declarations and <code>let</code> bindings.</p>
</div>
<div class="paragraph">
<p>ClojureScript vectors have enclosing brackets <code>[]</code> in their syntax literals. They can be created with <code>vector</code> and from
another collection with <code>vec</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">vector? </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nb">vector </span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [0 1 2]</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-o">&#39;</span><span class="tok-p">(</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [0 1 2]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Vectors are, like lists, ordered collections of heterogeneous values. Unlike lists, vectors grow naturally from the tail,
so the <code>conj</code> operation appends items to the end of a vector. Insertion on the end of a vector is effectively constant
time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [0 1 2]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another thing that differentiates lists and vectors is that vectors are indexed collections and as such support efficient
random index access and non-destructive updates. We can use the familiar <code>nth</code> function to retrieve values given an index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">nth </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">]</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since vectors associate sequential numeric keys (indexes) to values, we can treat them as an associative data structure. ClojureScript
provides the <code>assoc</code> function that, given an associative data structure and a set of key-value pairs, yields a new data structure with
the values corresponding to the keys modified. Indexes begin at zero for the first element in a vector.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">assoc </span><span class="tok-p">[</span><span class="tok-s">&quot;cero&quot;</span> <span class="tok-s">&quot;uno&quot;</span> <span class="tok-s">&quot;two&quot;</span><span class="tok-p">]</span> <span class="tok-mi">2</span> <span class="tok-s">&quot;dos&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [&quot;cero&quot; &quot;uno&quot; &quot;dos&quot;]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we can only <code>assoc</code> to a key that is either contained in the vector already or if it&#8217;s the last position in a vector:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">assoc </span><span class="tok-p">[</span><span class="tok-s">&quot;cero&quot;</span> <span class="tok-s">&quot;uno&quot;</span> <span class="tok-s">&quot;dos&quot;</span><span class="tok-p">]</span> <span class="tok-mi">3</span> <span class="tok-s">&quot;tres&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [&quot;cero&quot; &quot;uno&quot; &quot;dos&quot; &quot;tres&quot;]</span>

<span class="tok-p">(</span><span class="tok-nb">assoc </span><span class="tok-p">[</span><span class="tok-s">&quot;cero&quot;</span> <span class="tok-s">&quot;uno&quot;</span> <span class="tok-s">&quot;dos&quot;</span><span class="tok-p">]</span> <span class="tok-mi">4</span> <span class="tok-s">&quot;cuatro&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; Error: Index 4 out of bounds [0,3]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Perhaps surprisingly, associative data structures can also be used as functions. They are functions of their keys to the values they
are associated with. In the case of vectors, if the given key is not present an exception is thrown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">([</span><span class="tok-s">&quot;cero&quot;</span> <span class="tok-s">&quot;uno&quot;</span> <span class="tok-s">&quot;dos&quot;</span><span class="tok-p">]</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;cero&quot;</span>

<span class="tok-p">([</span><span class="tok-s">&quot;cero&quot;</span> <span class="tok-s">&quot;uno&quot;</span> <span class="tok-s">&quot;dos&quot;</span><span class="tok-p">]</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;dos&quot;</span>

<span class="tok-p">([</span><span class="tok-s">&quot;cero&quot;</span> <span class="tok-s">&quot;uno&quot;</span> <span class="tok-s">&quot;dos&quot;</span><span class="tok-p">]</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; Error: Not item 3 in vector of length 3</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As with lists, vectors can be also used as stack with the <code>peek</code>, <code>pop</code> and <code>conj</code> functions. Note, however, that vectors grow
from the opposite end of the collection as lists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">vector-stack</span> <span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nb">peek </span><span class="tok-nv">vector-stack</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 2</span>

<span class="tok-p">(</span><span class="tok-nb">pop </span><span class="tok-nv">vector-stack</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [0 1]</span>

<span class="tok-p">(</span><span class="tok-nf">type</span> <span class="tok-p">(</span><span class="tok-nb">pop </span><span class="tok-nv">vector-stack</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; cljs.core/PersistentVector</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">vector-stack</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; [0 1 2 3]</span>

<span class="tok-p">(</span><span class="tok-nf">type</span> <span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">vector-stack</span> <span class="tok-mi">3</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; cljs.core/PersistentVector</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>map</code> and <code>filter</code> operations return lazy sequences, but as it is common to need a fully realized sequence after performing those operations,
vector-returning counterparts of such functions are available as <code>mapv</code> and <code>filterv</code>. They have the advantages of being faster
than building a vector from a lazy sequence and making your intent more explicit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">map inc </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (1 2 3)</span>

<span class="tok-p">(</span><span class="tok-nf">type</span> <span class="tok-p">(</span><span class="tok-nb">map inc </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">]))</span>
<span class="tok-c1">;; =&gt; cljs.core/LazySeq</span>

<span class="tok-p">(</span><span class="tok-nf">mapv</span> <span class="tok-nb">inc </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; [1 2 3]</span>

<span class="tok-p">(</span><span class="tok-nf">type</span> <span class="tok-p">(</span><span class="tok-nf">mapv</span> <span class="tok-nb">inc </span><span class="tok-p">[</span><span class="tok-mi">0</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">]))</span>
<span class="tok-c1">;; =&gt; cljs.core/PersistentVector</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maps-2"><a class="link" href="#maps-2">Maps</a></h5>
<div class="paragraph">
<p>Maps are ubiquitous in ClojureScript. Like vectors, they are also used as a syntactic construct for attaching metadata to
vars. Any ClojureScript data structure can be used as a key in a map, although it&#8217;s common to use keywords since can also
be called as functions.</p>
</div>
<div class="paragraph">
<p>ClojureScript maps are written literally as key-value pairs enclosed in braces <code>{}</code>. Alternatively, they can be created
with the <code>hash-map</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">map? </span><span class="tok-p">{</span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nb">hash-map </span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; {:name &quot;Cirilla&quot;}</span>

<span class="tok-p">(</span><span class="tok-nb">hash-map </span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span> <span class="tok-ss">:surname</span> <span class="tok-s">&quot;Fiona&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; {:name &quot;Cirilla&quot; :surname &quot;Fiona&quot;}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since regular maps don&#8217;t have a specific order, the <code>conj</code> operation just adds one or more key-value pairs to a map. <code>conj</code>
for maps expects one or more sequences of key-value pairs as its last arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">ciri</span> <span class="tok-p">{</span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">ciri</span> <span class="tok-p">[</span><span class="tok-ss">:surname</span> <span class="tok-s">&quot;Fiona&quot;</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; {:name &quot;Cirilla&quot;, :surname &quot;Fiona&quot;}</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">ciri</span> <span class="tok-p">[</span><span class="tok-ss">:surname</span> <span class="tok-s">&quot;Fiona&quot;</span><span class="tok-p">]</span> <span class="tok-p">[</span><span class="tok-ss">:occupation</span> <span class="tok-s">&quot;Wizard&quot;</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; {:name &quot;Cirilla&quot;, :surname &quot;Fiona&quot;, :occupation &quot;Wizard&quot;}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Maps associate keys to values and, as such, are an associative data structure. They support adding associations with <code>assoc</code> and,
unlike vectors, removing them with <code>dissoc</code>. Let&#8217;s explore these functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">assoc </span><span class="tok-p">{</span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">}</span> <span class="tok-ss">:surname</span> <span class="tok-s">&quot;Fiona&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; {:name &quot;Cirilla&quot;, :surname &quot;Fiona&quot;}</span>

<span class="tok-p">(</span><span class="tok-nb">dissoc </span><span class="tok-p">{</span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">}</span> <span class="tok-ss">:name</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; {}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Maps are also functions of their keys, returning the values related to the given key. Unlike vectors, they return <code>nil</code> if we supply
a key that is not present in the map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">({</span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">}</span> <span class="tok-ss">:name</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Cirilla&quot;</span>

<span class="tok-p">({</span><span class="tok-ss">:name</span> <span class="tok-s">&quot;Cirilla&quot;</span><span class="tok-p">}</span> <span class="tok-ss">:surname</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ClojureScript also offers sorted hash maps which behave like their unsorted versions but preserve order when iterating over them. We
can create a sorted map with default ordering with <code>sorted-map</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">sm</span> <span class="tok-p">(</span><span class="tok-nb">sorted-map </span><span class="tok-ss">:c</span> <span class="tok-mi">2</span> <span class="tok-ss">:b</span> <span class="tok-mi">1</span> <span class="tok-ss">:a</span> <span class="tok-mi">0</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; {:a 0, :b 1, :c 2}</span>

<span class="tok-p">(</span><span class="tok-nb">keys </span><span class="tok-nv">sm</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (:a :b :c)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we need a custom ordering we can provide a comparator function to <code>sorted-map-by</code>, let&#8217;s see an example inverting the value
returned by the built-in <code>compare</code> function. Comparator functions take two elements to compare and returns -1 (less than), 0 (equal)
or 1 (greater than):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">reverse-compare</span> <span class="tok-p">(</span><span class="tok-nb">comp - </span><span class="tok-nv">compare</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">sm</span> <span class="tok-p">(</span><span class="tok-nb">sorted-map-by </span><span class="tok-nv">reverse-compare</span> <span class="tok-ss">:a</span> <span class="tok-mi">0</span> <span class="tok-ss">:b</span> <span class="tok-mi">1</span> <span class="tok-ss">:c</span> <span class="tok-mi">2</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; {:c 2, :b 1, :a 0}</span>

<span class="tok-p">(</span><span class="tok-nb">keys </span><span class="tok-nv">sm</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (:c :b :a)</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sets-2"><a class="link" href="#sets-2">Sets</a></h5>
<div class="paragraph">
<p>Sets in ClojureScript have literal syntax as values enclosed in <code>#{}</code> and they can be created with the <code>set</code> constructor. They are
unordered collections of values without duplicates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">set?</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-sc">\a</span> <span class="tok-sc">\e</span> <span class="tok-sc">\i</span> <span class="tok-sc">\o</span> <span class="tok-sc">\u</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nb">set </span><span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; #{1 2 3}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Set literals can not contain duplicate values. If you accidentaly write a set literal with duplicates an error will be thrown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">}</span>
<span class="tok-c1">;; clojure.lang.ExceptionInfo: Duplicate key: 1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are many operations that can be performed with sets, although are located in the <code>clojure.set</code> namespace and thus need to be imported.
You&#8217;ll learn the details of namespacing later, for now you only need to know that we are loading a namespace called <code>clojure.set</code> and binding
it to the <code>s</code> symbol.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">clojure.set</span> <span class="tok-ss">:as</span> <span class="tok-nv">s</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">danish-vowels</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-sc">\a</span> <span class="tok-sc">\e</span> <span class="tok-sc">\i</span> <span class="tok-sc">\o</span> <span class="tok-sc">\u</span> <span class="tok-sc">\æ</span> <span class="tok-sc">\ø</span> <span class="tok-sc">\å</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;å&quot; &quot;æ&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot; &quot;ø&quot;}</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">spanish-vowels</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-sc">\a</span> <span class="tok-sc">\e</span> <span class="tok-sc">\i</span> <span class="tok-sc">\o</span> <span class="tok-sc">\u</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot;}</span>

<span class="tok-p">(</span><span class="tok-nf">s/difference</span> <span class="tok-nv">danish-vowels</span> <span class="tok-nv">spanish-vowels</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{&quot;å&quot; &quot;æ&quot; &quot;ø&quot;}</span>

<span class="tok-p">(</span><span class="tok-nf">s/union</span> <span class="tok-nv">danish-vowels</span> <span class="tok-nv">spanish-vowels</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;å&quot; &quot;æ&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot; &quot;ø&quot;}</span>

<span class="tok-p">(</span><span class="tok-nf">s/intersection</span> <span class="tok-nv">danish-vowels</span> <span class="tok-nv">spanish-vowels</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot;}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A nice property of immutable sets is that they can be nested, languages that have mutable sets can end up containing duplicate values but
that can&#8217;t happen in ClojureScript. In fact, all ClojureScript data structures can be nested arbitrarily due to immutability.</p>
</div>
<div class="paragraph">
<p>Sets also support the generic <code>conj</code> operation, as every other collection does.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">spanish-vowels</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-sc">\a</span> <span class="tok-sc">\e</span> <span class="tok-sc">\i</span> <span class="tok-sc">\o</span> <span class="tok-sc">\u</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot;}</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">danish-vowels</span> <span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">spanish-vowels</span> <span class="tok-sc">\æ</span> <span class="tok-sc">\ø</span> <span class="tok-sc">\å</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot; &quot;æ&quot; &quot;ø&quot; &quot;å&quot;}</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">}</span> <span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{1 3 2}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>They acts as read-only associative data that associates the values it contains to themselves. Since every value except <code>nil</code> and <code>false</code> are
falsy in ClojureScript, we can use sets as predicate functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">vowels</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-sc">\a</span> <span class="tok-sc">\e</span> <span class="tok-sc">\i</span> <span class="tok-sc">\o</span> <span class="tok-sc">\u</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; #{&quot;a&quot; &quot;e&quot; &quot;i&quot; &quot;o&quot; &quot;u&quot;}</span>

<span class="tok-p">(</span><span class="tok-nb">get </span><span class="tok-nv">vowels</span> <span class="tok-sc">\b</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; nil</span>

<span class="tok-p">(</span><span class="tok-nb">contains? </span><span class="tok-nv">vowels</span> <span class="tok-sc">\b</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span>

<span class="tok-p">(</span><span class="tok-nf">vowels</span> <span class="tok-sc">\a</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;a&quot;</span>

<span class="tok-p">(</span><span class="tok-nb">filter </span><span class="tok-nv">vowels</span> <span class="tok-s">&quot;Hound dog&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; (&quot;o&quot; &quot;u&quot; &quot;o&quot;)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Sets have a sorted counterpart like maps do, created using the functions <code>sorted-set</code> and <code>sorted-set-by</code> which are analogous to map&#8217;s <code>sorted-map</code> and <code>sorted-map-by</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">unordered-set</span> <span class="tok-o">#</span><span class="tok-p">{[</span><span class="tok-mi">0</span><span class="tok-p">]</span> <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]})</span>
<span class="tok-c1">;; =&gt; #{[0] [2] [1]}</span>

<span class="tok-p">(</span><span class="tok-nb">seq </span><span class="tok-nv">unordered-set</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; ([0] [2] [1])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">ordered-set</span> <span class="tok-p">(</span><span class="tok-nb">sorted-set </span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-p">]</span> <span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span> <span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]))</span>
<span class="tok-c1">;; =&gt;# {[0] [1] [2]}</span>

<span class="tok-p">(</span><span class="tok-nb">seq </span><span class="tok-nv">unordered-set</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; ([0] [1] [2])</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="queues"><a class="link" href="#queues">Queues</a></h5>
<div class="paragraph">
<p>ClojureScript also provides a persistent and immutable queue. Queues don&#8217;t have literal syntax since they are not used as pervasively as other collection types.</p>
</div>
<div class="paragraph">
<p>There are no convenient constructor functions for creating persistent queues. Instead of that, we can get an empty instance using <code>PersistentQueue`s
`EMPTY</code> attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pq</span> <span class="tok-p">(</span><span class="tok-nf">.-EMPTY</span> <span class="tok-nv">PersistentQueue</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; #queue []</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>conj</code> to add values to a queue adds items onto the rear:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pq</span> <span class="tok-p">(</span><span class="tok-nf">.-EMPTY</span> <span class="tok-nv">PersistentQueue</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; #queue []</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-p">(</span><span class="tok-nf">.-EMPTY</span> <span class="tok-nv">PersistentQueue</span><span class="tok-p">)</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #queue [1 2 3]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A thing to bear in mind about queues is that the stack operations don&#8217;t follow the usual stack semantics (pushing and popping from the same end), pops
take values from the front position and pushes with <code>conj</code> append elements to the back.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pq</span> <span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-p">(</span><span class="tok-nf">.-EMPTY</span> <span class="tok-nv">PersistentQueue</span><span class="tok-p">)</span> <span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">3</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; #queue [1 2 3]</span>

<span class="tok-p">(</span><span class="tok-nb">peek </span><span class="tok-nv">pq</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 1</span>

<span class="tok-p">(</span><span class="tok-nb">pop </span><span class="tok-nv">pq</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #queue [2 3]</span>

<span class="tok-p">(</span><span class="tok-nb">conj </span><span class="tok-nv">pq</span> <span class="tok-mi">4</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #queue [1 2 3 4]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Queues are not as frequently used as lists or vectors but is good to know that they are available in ClojureScript, they may come in handy some time.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="destructuring"><a class="link" href="#destructuring">2.8. Destructuring</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="namespaces"><a class="link" href="#namespaces">2.9. Namespaces</a></h3>
<div class="sect3">
<h4 id="defining-a-namespace"><a class="link" href="#defining-a-namespace">2.9.1. Defining a namespace</a></h4>
<div class="paragraph">
<p>The <em>namespace</em> is ClojureScript&#8217;s fundamental unit of code modularity. Namespaces are analogous to Java packages or
Ruby and Python modules, and can be defined with the <code>ns</code> macro. Maybe if you have looked at a little bit of
ClojureScript source you have seen something like this at begining of the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.core</span>
  <span class="tok-s">&quot;Some docstring for the namespace.&quot;</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">x</span> <span class="tok-s">&quot;hello&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Namespaces are dynamic, meaning you can create one at any time. The convention however, is to have one namespace
per file. Naturally, a namespace definition is usually at the beginning of the file, followed by an optional
docstring.</p>
</div>
<div class="paragraph">
<p>Previously we have explained vars and symbols. Every var that you define will be associated
with it&#8217;s namespace. If you do not define a concrete namespace then the default one called "user" will be
used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">x</span> <span class="tok-s">&quot;hello&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #&#39;user/x</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="loading-other-namespaces"><a class="link" href="#loading-other-namespaces">2.9.2. Loading other namespaces</a></h4>
<div class="paragraph">
<p>Defining a namespace and the vars in it is really easy, but it&#8217;s not very useful if we can&#8217;t
use them from other namespaces. For this purpose, the <code>ns</code> macro offers a simple way to load other
namespaces.</p>
</div>
<div class="paragraph">
<p>Observe the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.main</span>
  <span class="tok-p">(</span><span class="tok-ss">:require</span> <span class="tok-nv">myapp.core</span>
            <span class="tok-nv">clojure.string</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">clojure.string/upper-case</span> <span class="tok-nv">myapp.core/x</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;HELLO&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can observe, we are using fully qualified names (namespace + var name) for access to vars and
functions from different namespaces.</p>
</div>
<div class="paragraph">
<p>While this will let you access other namespaces, it&#8217;s also repetitive and overly verbose. It will be especially
uncomfortable if the name of a  namespace is very large. To solve that, you can use the <code>:as</code> directive to
create an additional (usually shorter) alias to the namespace.
This is how it can be done:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.main</span>
  <span class="tok-p">(</span><span class="tok-ss">:require</span> <span class="tok-p">[</span><span class="tok-nv">myapp.core</span> <span class="tok-ss">:as</span> <span class="tok-nv">core</span><span class="tok-p">]</span>
            <span class="tok-p">[</span><span class="tok-nv">clojure.string</span> <span class="tok-ss">:as</span> <span class="tok-nv">str</span><span class="tok-p">]))</span>

<span class="tok-p">(</span><span class="tok-nf">str/upper-case</span> <span class="tok-nv">core/x</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;HELLO&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionaly, <em>ClojureScript</em> offers a simple way to refer to specific vars or functions from a concrete namespace using the <code>:refer</code> directive.</p>
</div>
<div class="paragraph">
<p>The <code>:refer</code> directive has two possible arguments: the <code>:all</code> keyword or a vector of symbols that will
refer to vars in the namespace. With <code>:all</code>, we are indicating that we want to refer all public vars from the
namespace, and with vector we can specify the specific subset of vars that we want. Effectively, it is as if those vars and
functions are now part of your namespace, and you do not need to qualify them at all.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.main</span>
  <span class="tok-p">(</span><span class="tok-ss">:require</span> <span class="tok-p">[</span><span class="tok-nv">myapp.core</span> <span class="tok-ss">:refer</span> <span class="tok-ss">:all</span><span class="tok-p">]</span>
            <span class="tok-p">[</span><span class="tok-nv">clojure.string</span> <span class="tok-ss">:refer</span> <span class="tok-p">[</span><span class="tok-nv">upper-case</span><span class="tok-p">]]))</span>
<span class="tok-p">(</span><span class="tok-nf">upper-case</span> <span class="tok-nv">x</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;HELLO&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally, you should know that everything located in the <code>cljs.core</code> namespace is automatically
loaded and you should not require it explicitly. Sometimes you may want declare vars that will clash
with some others defined in the <code>cljs.core</code> namespace. To do this, the <code>ns</code> macro offers another directive that
allows you to exclude specific symbols and prevent them from being automatically loaded.</p>
</div>
<div class="paragraph">
<p>Observe the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.main</span>
  <span class="tok-p">(</span><span class="tok-ss">:refer-clojure</span> <span class="tok-ss">:exclude</span> <span class="tok-p">[</span><span class="tok-nv">min</span><span class="tok-p">]))</span>

<span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">min</span>
  <span class="tok-p">[</span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-k">if </span><span class="tok-p">(</span><span class="tok-nb">&gt; </span><span class="tok-nv">x</span> <span class="tok-nv">y</span><span class="tok-p">)</span>
    <span class="tok-nv">y</span>
    <span class="tok-nv">x</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ns</code> macro also has other directives for loading host classes (<code>:import</code>) and macros
(<code>:refer-macros</code>), but these are explained in other sections.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="abstractions-and-polymorphism"><a class="link" href="#abstractions-and-polymorphism">2.10. Abstractions and Polymorphism</a></h3>
<div class="paragraph">
<p>I&#8217;m sure that at more than one time you have found yourself in this situation: you have defined a great
abstraction (using interfaces or something similar) for your "business logic" and you have found
the need to deal with another module over which you have absolutely no control, and you probably
were thinking of creating adapters, proxies, and other approaches that imply a great amount
of additional complexity.</p>
</div>
<div class="paragraph">
<p>Some dynamic languages allow "monkey-patching"; languages where the classes are open and any
method can be defined and redefined at any time. Also, it is well known that this technique is a very
bad practice.</p>
</div>
<div class="paragraph">
<p>We can not trust languages that allow you to silently overwrite methods that you are using when you import third party libraries; you can not expect
consistent behavior when this happens.</p>
</div>
<div class="paragraph">
<p>These symptoms are commonly called the "expression problem".
see <a href="http://en.wikipedia.org/wiki/Expression_problem" class="bare">http://en.wikipedia.org/wiki/Expression_problem</a> for more details</p>
</div>
<div class="sect3">
<h4 id="protocols"><a class="link" href="#protocols">2.10.1. Protocols</a></h4>
<div class="paragraph">
<p>The <em>ClojureScript</em> primitive for defining "interfaces" is called a Protocol. A protocol consists of
a name and set of functions. All the functions have at least one argument corresponding to the
<code>this</code> in javascript or <code>self</code> in Python.</p>
</div>
<div class="paragraph">
<p>Protocols provide a type-based polymorphism, and the dispatch is always done by the
first argument (equivalent to JavaScript’s <code>this</code>, as previously mentioned).</p>
</div>
<div class="paragraph">
<p>A protocol looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.foobar</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-kd">defprotocol </span><span class="tok-nv">IProtocolName</span>
  <span class="tok-s">&quot;A docstring describing the protocol.&quot;</span>
  <span class="tok-p">(</span><span class="tok-nf">sample-method</span> <span class="tok-p">[</span><span class="tok-nv">this</span><span class="tok-p">]</span> <span class="tok-s">&quot;A doc string of the function associated with the protocol.&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the "I" prefix is commonly used to designate the separation of protocols and types. In the clojure
community there many different opinions about how the "I" prefix should be used. In our opinion, it is an
acceptable solution to avoid name clashing and possible confusion.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>From the user perspective, protocol functions are simply plain functions defined in the namespace
where the protocol is defined. As you can intuit, this namespacing of protocols allows us to avoid
any conflict between implemented protocols for the same type.</p>
</div>
<div class="sect4">
<h5 id="extending-existing-types"><a class="link" href="#extending-existing-types">Extending existing types</a></h5>
<div class="paragraph">
<p>One of the big strengths of protocols is the ability to extend existing and maybe third party types,
and this operation can be done in different ways. The majority of time you will tend to use
the <strong>extend-protocol</strong> or the <strong>extend-type</strong> macros.</p>
</div>
<div class="paragraph">
<p>This is an example of how the <strong>extend-type</strong> macro can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">extend-type</span> <span class="tok-nv">TypeA</span>
  <span class="tok-nv">ProtocolA</span>
  <span class="tok-p">(</span><span class="tok-nf">function-from-protocol-a</span> <span class="tok-p">[</span><span class="tok-nv">this</span><span class="tok-p">]</span>
    <span class="tok-c1">;; implementation here</span>
    <span class="tok-p">)</span>

  <span class="tok-nv">ProtocolB</span>
  <span class="tok-p">(</span><span class="tok-nf">function-from-protocol-b-1</span> <span class="tok-p">[</span><span class="tok-nv">this</span> <span class="tok-nv">parameter1</span><span class="tok-p">]</span>
    <span class="tok-c1">;; implementation here</span>
    <span class="tok-p">)</span>
  <span class="tok-p">(</span><span class="tok-nf">function-from-protocol-b-2</span> <span class="tok-p">[</span><span class="tok-nv">this</span> <span class="tok-nv">parameter1</span> <span class="tok-nv">parameter2</span><span class="tok-p">]</span>
    <span class="tok-c1">;; implementation here</span>
    <span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can observe that with <strong>extend-type</strong> you are extending a single type with different protocols
in a single expression. In comparison, <strong>extend-protocol</strong> does the inverse;
given a protocol, it adds implementations for multiple types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">extend-protocol</span> <span class="tok-nv">ProtocolA</span>
  <span class="tok-nv">TypeA</span>
  <span class="tok-p">(</span><span class="tok-nf">function-from-protocol-a</span> <span class="tok-p">[</span><span class="tok-nv">this</span><span class="tok-p">]</span>
    <span class="tok-c1">;; implementation here</span>
    <span class="tok-p">)</span>

  <span class="tok-nv">TypeB</span>
  <span class="tok-p">(</span><span class="tok-nf">function-from-protocol-a</span> <span class="tok-p">[</span><span class="tok-nv">this</span><span class="tok-p">]</span>
    <span class="tok-c1">;; implementation here</span>
    <span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are other ways to extend a type with a protocol implementation, but they will be covered
in another section of this book.</p>
</div>
</div>
<div class="sect4">
<h5 id="participate-in-clojurescript-abstractions"><a class="link" href="#participate-in-clojurescript-abstractions">Participate in ClojureScript abstractions</a></h5>
<div class="paragraph">
<p>ClojureScript it self is built up on abstractions defined as protocols. Almost all behavior
in the <em>ClojureScript</em> language itself can be adapted to third party libraries. Let&#8217;s go to see a
real life example.</p>
</div>
<div class="paragraph">
<p>In previous sections we have explained the different kinds of built-in collections. For this example we
will use the <strong>Set</strong>. See this snipped of code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">mynums</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-nb">filter </span><span class="tok-nv">mynums</span> <span class="tok-p">[</span><span class="tok-mi">1</span> <span class="tok-mi">2</span> <span class="tok-mi">4</span> <span class="tok-mi">5</span> <span class="tok-mi">1</span> <span class="tok-mi">3</span> <span class="tok-mi">4</span> <span class="tok-mi">5</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (1 2 1)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>What happened? In this case, the <em>set</em> type implements the <em>ClojureScript</em> internal
<code>IFn</code> protocol that represents an abstraction for functions or anything callable. This way it can be
used like a callable predicate in filter.</p>
</div>
<div class="paragraph">
<p>Ok, but what happens if we want use a regular expression as predicate function for filtering
a collection of strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">filter </span><span class="tok-o">#</span><span class="tok-s">&quot;^foo&quot;</span> <span class="tok-p">[</span><span class="tok-s">&quot;haha&quot;</span> <span class="tok-s">&quot;foobar&quot;</span> <span class="tok-s">&quot;baz&quot;</span> <span class="tok-s">&quot;foobaz&quot;</span><span class="tok-p">])</span>
<span class="tok-c1">;; TypeError: Cannot call undefined</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The exception is raised because the RegExp type does not implements the <code>IFn</code> protocol
so it cannot behave like a callable, but that can be easily fixed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">extend-type</span> <span class="tok-nv">js/RegExp</span>
  <span class="tok-nv">IFn</span>
  <span class="tok-p">(</span><span class="tok-nf">-invoke</span>
   <span class="tok-p">([</span><span class="tok-nv">this</span> <span class="tok-nv">a</span><span class="tok-p">]</span>
     <span class="tok-p">(</span><span class="tok-nb">re-find </span><span class="tok-nv">this</span> <span class="tok-nv">a</span><span class="tok-p">))))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let’s analyze this:  we are extending the <code>js/RegExp</code> type so that it implements the <code>invoke</code> function in the
<code>IFn</code> protocol. To invoke a regular expression <code>a</code> as if it were a function, call the <code>re-find</code> function with
the object of the function and the pattern.</p>
</div>
<div class="paragraph">
<p>Now, you will be able use the regex instances as predicates in filter operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">filter </span><span class="tok-o">#</span><span class="tok-s">&quot;^foo&quot;</span> <span class="tok-p">[</span><span class="tok-s">&quot;haha&quot;</span> <span class="tok-s">&quot;foobar&quot;</span> <span class="tok-s">&quot;baz&quot;</span> <span class="tok-s">&quot;foobaz&quot;</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; (&quot;foobar&quot; &quot;foobaz&quot;)</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="introspection-using-protocols"><a class="link" href="#introspection-using-protocols">Introspection using Protocols</a></h5>
<div class="paragraph">
<p><em>ClojureScript</em> comes with a useful function that allows runtime introspection: <code>satisfies?</code>. The
purpose of this function is to determinate at runtime if some object (instance of some type) satisfies the
concrete protocol.</p>
</div>
<div class="paragraph">
<p>So, with previous examples, if we check if a <code>set</code> instance satisfies a <strong>IFn</strong> protocol, it should
return <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">satisfies?</span> <span class="tok-nv">IFn</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="multimethods"><a class="link" href="#multimethods">2.10.2. Multimethods</a></h4>
<div class="paragraph">
<p>We have previously talked about protocols, which solve a very common use case of polymorphism:
dispatch by type. But in some circumstances, the protocol approach it can be limiting. And
here, <strong>multimethods</strong> come to the rescue.</p>
</div>
<div class="paragraph">
<p>These <strong>multimethods</strong> are not limited to type dispatch only; instead, they also offer dispatch
by types of multiple arguments and by value. They also allow ad-hoc hierarchies to be defined. Also,
like protocols, multimethods are an "Open System," so you or any third parties can extend a multimethod for
new types.</p>
</div>
<div class="paragraph">
<p>The basic constructions of <strong>multimethods</strong> are the <code>defmulti</code> and <code>defmethod</code> forms. The
<code>defmulti</code> form is used to create the multimethod with an initial dispatch function. This is
a model of what it looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defmulti </span><span class="tok-nv">say-hello</span>
  <span class="tok-s">&quot;A polymorphic function that return a greetings message</span>
<span class="tok-s">  depending on the language key with default lang as `:en`&quot;</span>
  <span class="tok-p">(</span><span class="tok-k">fn </span><span class="tok-p">[</span><span class="tok-nv">param</span><span class="tok-p">]</span> <span class="tok-p">(</span><span class="tok-ss">:locale</span> <span class="tok-nv">param</span><span class="tok-p">))</span>
  <span class="tok-ss">:default</span> <span class="tok-ss">:en</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The anonymous function defined within the <code>defmulti</code> form is a dispatch function. It will
be called in every call to <code>say-hello</code> function and should return some kind of marker object
that will be used for dispatch. In our example it returns the contents of the <code>:locale</code> key
of the first argument.</p>
</div>
<div class="paragraph">
<p>And finally, you should add implementations. That is done with <code>defmethod</code> form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defmethod </span><span class="tok-nv">say-hello</span> <span class="tok-ss">:en</span>
  <span class="tok-p">[</span><span class="tok-nv">person</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">str </span><span class="tok-s">&quot;Hello &quot;</span> <span class="tok-p">(</span><span class="tok-ss">:name</span> <span class="tok-nv">person</span> <span class="tok-s">&quot;Anonymous&quot;</span><span class="tok-p">)))</span>

<span class="tok-p">(</span><span class="tok-kd">defmethod </span><span class="tok-nv">say-hello</span> <span class="tok-ss">:es</span>
  <span class="tok-p">[</span><span class="tok-nv">person</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">str </span><span class="tok-s">&quot;Hola &quot;</span> <span class="tok-p">(</span><span class="tok-ss">:name</span> <span class="tok-nv">person</span> <span class="tok-s">&quot;Anónimo&quot;</span><span class="tok-p">)))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>So, if you execute that function over a hash map containing the <code>:locale</code> and optionally
the <code>:name</code> key, the multimethod will first call the dispatch function to determine the
dispatch value, then it will search for an implementation for that value. If an implementation
is found, the dispatcher will execute it. Otherwise, the dispatch will search for a default implementation
(if one is specified) and execute it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">say-hello</span> <span class="tok-p">{</span><span class="tok-ss">:locale</span> <span class="tok-ss">:es</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; &quot;Hola Anónimo&quot;</span>

<span class="tok-p">(</span><span class="tok-nf">say-hello</span> <span class="tok-p">{</span><span class="tok-ss">:locale</span> <span class="tok-ss">:en</span> <span class="tok-ss">:name</span> <span class="tok-s">&quot;Ciri&quot;</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; &quot;Hello Ciri&quot;</span>

<span class="tok-p">(</span><span class="tok-nf">say-hello</span> <span class="tok-p">{</span><span class="tok-ss">:locale</span> <span class="tok-ss">:fr</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; &quot;Hello Anonymous&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the default implementation is not specified, an exception will be raised notifying you
that some value does not have a implementation for that multimethod.</p>
</div>
</div>
<div class="sect3">
<h4 id="hierarchies"><a class="link" href="#hierarchies">2.10.3. Hierarchies</a></h4>
<div class="paragraph">
<p>Hierarchies are <em>ClojureScript</em>’s way to let you build whatever relations that your
domain may require. The hierarchies are defined in term of relations between named objects,
such as symbols, keywords or types.</p>
</div>
<div class="paragraph">
<p>The hierarchies can be defined globally or locally, depending on your needs. Like multimethods,
hierarchies are not limited to a single namespace. You can extend a hierarchy from any namespace,
not necessarily the one in which they are defined.</p>
</div>
<div class="paragraph">
<p>The global namespace is more limited, for good reasons. Keywords or symbols that are not namespaced can
not be used in the global hierarchy. That behavior helps prevent unexpected situations when
two or more third party libraries use the same symbol for different semantics.</p>
</div>
<div class="sect4">
<h5 id="defining-a-hierarchy"><a class="link" href="#defining-a-hierarchy">Defining a hierarchy</a></h5>
<div class="paragraph">
<p>The hierarchy relations should be established using the <code>derive</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">derive</span> <span class="tok-ss">::circle</span> <span class="tok-ss">::shape</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-nf">derive</span> <span class="tok-ss">::box</span> <span class="tok-ss">::shape</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We have just defined a set of relationships between namespaced keywords. In this case the
<code>::circle</code> is a child of <code>::shape</code>, and <code>::box</code> is also a child of <code>::shape</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The <code>::circle</code> keyword syntax is a shorthand for <code>:current.ns/circle</code>. So if you are executing
it in a REPL, <code>::circle</code> will be evaluated as <code>:cljs.user/circle</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="hierarchies-and-introspection"><a class="link" href="#hierarchies-and-introspection">Hierarchies and introspection</a></h5>
<div class="paragraph">
<p><em>ClojureScript</em> comes with a little toolset of functions that allow runtime introspection
of globally or locally defined hierarchies. This toolset consists of three functions:
<code>isa?</code>, <code>ancestors</code>, and <code>descendants</code>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example of how it can be used with the hierarchy defined in previous example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">ancestors</span> <span class="tok-ss">::box</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{:cljs.user/shape}</span>

<span class="tok-p">(</span><span class="tok-nf">descendants</span> <span class="tok-ss">::shape</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #{:cljs.user/circle :cljs.user/box}</span>

<span class="tok-p">(</span><span class="tok-nf">isa?</span> <span class="tok-ss">::box</span> <span class="tok-ss">::shape</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nf">isa?</span> <span class="tok-ss">::rect</span> <span class="tok-ss">::shape</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="locally-defined-hierarchies"><a class="link" href="#locally-defined-hierarchies">Locally defined hierarchies</a></h5>
<div class="paragraph">
<p>As we mentioned previously, in <em>ClojureScript</em> you also can define local hierarchies. This can be
done with the <code>make-hierarchy</code> function. Here is an example of how you can replicate the previous
example using a local hierarchy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">h</span> <span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">make-hierarchy</span><span class="tok-p">)</span>
           <span class="tok-p">(</span><span class="tok-nf">derive</span> <span class="tok-ss">:box</span> <span class="tok-ss">:shape</span><span class="tok-p">)</span>
           <span class="tok-p">(</span><span class="tok-nf">derive</span> <span class="tok-ss">:circle</span> <span class="tok-ss">:shape</span><span class="tok-p">)))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can use the same introspection functions with that locally defined hierarchy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">isa?</span> <span class="tok-nv">h</span> <span class="tok-ss">:box</span> <span class="tok-ss">:shape</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true</span>

<span class="tok-p">(</span><span class="tok-nf">isa?</span> <span class="tok-ss">:box</span> <span class="tok-ss">:shape</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can observe, in local hierarchies we can use normal (not namespace qualified) keywords,
and if we execute the <code>isa?</code> without passing the local hierarchy parameter, it returns <code>false</code>
as expected.</p>
</div>
</div>
<div class="sect4">
<h5 id="hierarchies-in-multimethods"><a class="link" href="#hierarchies-in-multimethods">Hierarchies in multimethods</a></h5>
<div class="paragraph">
<p>One of the big advantages of hierarchies is that they works very well together with multimethods.
This is because multimethods by default use the <code>isa?</code> function for the last step of dispatching.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example to clearly understand what that means. Firstly, define the multimethod with
<code>defmulti</code> form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defmulti </span><span class="tok-nv">stringify-shape</span>
  <span class="tok-s">&quot;A function that prints a human readable representation</span>
<span class="tok-s">  of a shape keyword.&quot;</span>
  <span class="tok-nv">identity</span>
  <span class="tok-ss">:hierarchy</span> <span class="tok-nv">h</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>:hierarchy</code> keyword parameter we indicate to the multimethod that hierarchy we want to use;
if it is not specified, the global hierarchy will be used.</p>
</div>
<div class="paragraph">
<p>Secondly, we define an implementation for our multimethod using the <code>defmethod</code> form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defmethod </span><span class="tok-nv">stringify-shape</span> <span class="tok-ss">:box</span>
  <span class="tok-p">[</span><span class="tok-nv">_</span><span class="tok-p">]</span>
  <span class="tok-s">&quot;A box shape&quot;</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-kd">defmethod </span><span class="tok-nv">stringify-shape</span> <span class="tok-ss">:shape</span>
  <span class="tok-p">[</span><span class="tok-nv">_</span><span class="tok-p">]</span>
  <span class="tok-s">&quot;A generic shape&quot;</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-kd">defmethod </span><span class="tok-nv">stringify-shape</span> <span class="tok-ss">:default</span>
  <span class="tok-p">[</span><span class="tok-nv">_</span><span class="tok-p">]</span>
  <span class="tok-s">&quot;Unexpected object&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s see what happens if we execute that function with a box:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">stringify-shape</span> <span class="tok-ss">:box</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;A box shape&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now everything works as expected; the multimethod executes the direct matching implementation
for the given parameter. Next, let&#8217;s see what happens if we execute the same function but with the <code>:circle</code>
keyword as the parameter, which does not have the direct matching dispatch value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">stringify-shape</span> <span class="tok-ss">:circle</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;A generic shape&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The multimethod automatically resolves it using the provided hierarchy, and since <code>:circle</code> is
a descendant of <code>:shape</code>, the <code>:shape</code> implementation is executed.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="data-types"><a class="link" href="#data-types">2.11. Data types</a></h3>
<div class="paragraph">
<p>Until, now, we have used maps, sets, lists and vectors to represent our data. And in most cases, this is a
really great approach. But sometimes we need to define our own types, and in this book we will
call them <strong>datatypes</strong>.</p>
</div>
<div class="paragraph">
<p>A datatype provides the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A unique host-backed type, either named or anonymous.</p>
</li>
<li>
<p>The ability to implement protocols (inline).</p>
</li>
<li>
<p>Explicitly declared structure using fields or closures.</p>
</li>
<li>
<p>Map like behavior (via records, see below).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="deftype"><a class="link" href="#deftype">2.11.1. Deftype</a></h4>
<div class="paragraph">
<p>The most low level construction in <em>ClojureScript</em> for creating your own types is the <code>deftype</code> macro. As a
demonstration, we will define a type called <code>User</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">deftype </span><span class="tok-nv">User</span> <span class="tok-p">[</span><span class="tok-nv">firstname</span> <span class="tok-nv">lastname</span><span class="tok-p">])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the type has been defined, we can create an instance of our <code>User</code>. In the
following example, the <code>.</code> after <code>User</code> indicates that we are calling a constructor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">person</span> <span class="tok-p">(</span><span class="tok-nf">User.</span> <span class="tok-s">&quot;Triss&quot;</span> <span class="tok-s">&quot;Merigold&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And its fields can be accessed using the prefix-dot notation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">.-firstname</span> <span class="tok-nv">person</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Triss&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Types defined with <code>deftype</code> (and <code>defrecord</code>, which we will see later) creates a host-backed class-like object
associated with the current namespace. But it has some peculiarities when we intend to use or import
it from another namespace. The types in <em>ClojureScript</em> should be imported with the <code>:import</code> directive
of the <code>ns</code> macro:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myns.core</span>
  <span class="tok-p">(</span><span class="tok-ss">:import</span> <span class="tok-nv">otherns.User</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">User.</span> <span class="tok-s">&quot;Cirilla&quot;</span> <span class="tok-s">&quot;Fiona&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For convenience, <em>ClojureScript</em> also defines a constructor function caled <code>&#8594;User</code> that can be imported
in the common way using the <code>:require</code> directive.</p>
</div>
<div class="paragraph">
<p>We personally do not like this type of function, and we prefer to define our own constructors, with more
idiomatic names:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">make-user</span>
  <span class="tok-p">[</span><span class="tok-nv">firstname</span> <span class="tok-nv">lastname</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nf">User.</span> <span class="tok-nv">firstname</span> <span class="tok-nv">lastname</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And use it in our code instead of <code>&#8594;User</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="defrecord"><a class="link" href="#defrecord">2.11.2. Defrecord</a></h4>
<div class="paragraph">
<p>The record is a slightly higher level abstraction for defining types in <em>ClojureScript</em> and should be
preferred way to do it.</p>
</div>
<div class="paragraph">
<p>As we know, <em>ClojureScript</em> tends to use plain data types such as maps, but in most cases we need
a named type to represent the entities of our application. Here come the records.</p>
</div>
<div class="paragraph">
<p>A record is a datatype that implements the map protocol and therefore can be used like any other map.
And since records are also proper types, they support type-based polymorphism through protocols.</p>
</div>
<div class="paragraph">
<p>In summary: with records, we have the best of both worlds, maps that can play in different
abstractions.</p>
</div>
<div class="paragraph">
<p>Let start defining the <code>User</code> type but using records:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defrecord </span><span class="tok-nv">User</span> <span class="tok-p">[</span><span class="tok-nv">firstname</span> <span class="tok-nv">lastname</span><span class="tok-p">])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It looks really similar to the <code>deftype</code> syntax; in fact, it uses <code>deftype</code> behind the scenes as a low level
primitive for defining types.</p>
</div>
<div class="paragraph">
<p>Now, look at the difference with raw types for access to its fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">person</span> <span class="tok-p">(</span><span class="tok-nf">User.</span> <span class="tok-s">&quot;Yennefer&quot;</span> <span class="tok-s">&quot;of Vengerberg&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-ss">:firstname</span> <span class="tok-nv">user</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Yennefer&quot;</span>

<span class="tok-p">(</span><span class="tok-nb">get </span><span class="tok-nv">person</span> <span class="tok-ss">:firstname</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Yennefer&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As we mentioned previously, records are maps and act like tham:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">map? </span><span class="tok-nv">person</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And like maps, tham support extra fields that are not initially defined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">person2</span> <span class="tok-p">(</span><span class="tok-nb">assoc </span><span class="tok-nv">person</span> <span class="tok-ss">:age</span> <span class="tok-mi">92</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-ss">:age</span> <span class="tok-nv">person2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 92</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As we can see, the <code>assoc</code> function works as expected and returns a new instance of the same
type but with new key value pair. But take care with <code>dissoc</code>! Its behavior with records is slightly
different than with maps; it will return a new record if the field being dissociated is an optional
field, but it will return a plain map if you dissociate a mandatory field.</p>
</div>
<div class="paragraph">
<p>An other difference with maps is that records do not act like functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">plain-person</span> <span class="tok-p">{</span><span class="tok-ss">:firstname</span> <span class="tok-s">&quot;Yennefer&quot;</span>, <span class="tok-ss">:lastname</span> <span class="tok-s">&quot;of Vengerberg&quot;</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-nf">plain-person</span> <span class="tok-ss">:firstname</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Yennefer&quot;</span>

<span class="tok-p">(</span><span class="tok-nf">person</span> <span class="tok-ss">:firstname</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; person.User does not implement IFn protocol.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For convenience, the <code>defrecord</code> macro, like <code>deftype</code>, exposes a <code>&#8594;User</code> function, as well as an additional
<code>map&#8594;User</code> constructor function. We have the same opinion about that constructor as with
<code>deftype</code> defined ones: we recommend defining your own instead of using the other ones. But as they exist, let’s see
how they can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">cirilla</span> <span class="tok-p">(</span><span class="tok-nf">-&gt;User</span> <span class="tok-s">&quot;Cirilla&quot;</span> <span class="tok-s">&quot;Fiona&quot;</span><span class="tok-p">))</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">yen</span> <span class="tok-p">(</span><span class="tok-nf">map-&gt;User</span> <span class="tok-p">{</span><span class="tok-ss">:firstname</span> <span class="tok-s">&quot;Yennefer&quot;</span>
                     <span class="tok-ss">:lastname</span> <span class="tok-s">&quot;of Vengerberg&quot;</span><span class="tok-p">}))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="implementing-protocols"><a class="link" href="#implementing-protocols">2.11.3. Implementing protocols</a></h4>
<div class="paragraph">
<p>Both type definition primitives that we have seen so far allow inline implementations for protocols
(explained in a previous section). Let&#8217;s define one for example purposes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defprotocol </span><span class="tok-nv">IUser</span>
  <span class="tok-s">&quot;A common abstraction for working with user types.&quot;</span>
  <span class="tok-p">(</span><span class="tok-nf">full-name</span> <span class="tok-p">[</span><span class="tok-nv">_</span><span class="tok-p">]</span> <span class="tok-s">&quot;Get the full name of the user.&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, you can define a type with inline implementation for an abstraction, in our case the <code>IUser</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defrecord </span><span class="tok-nv">User</span> <span class="tok-p">[</span><span class="tok-nv">firstname</span> <span class="tok-nv">lastname</span><span class="tok-p">]</span>
  <span class="tok-nv">IUser</span>
  <span class="tok-p">(</span><span class="tok-nf">full-name</span> <span class="tok-p">[</span><span class="tok-nv">_</span><span class="tok-p">]</span>
    <span class="tok-p">(</span><span class="tok-nb">str </span><span class="tok-nv">firstname</span> <span class="tok-s">&quot; &quot;</span> <span class="tok-nv">lastname</span><span class="tok-p">)))</span>

<span class="tok-c1">;; Create an instance.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">user</span> <span class="tok-p">(</span><span class="tok-nf">User.</span> <span class="tok-s">&quot;Yennefer&quot;</span> <span class="tok-s">&quot;of Vengerberg&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">full-name</span> <span class="tok-nv">user</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Yennefer of Vengerberg&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="reify"><a class="link" href="#reify">2.11.4. Reify</a></h4>
<div class="paragraph">
<p>The <code>reify</code> macro lets you create an anonymous type that implements protocols. In contrast to
<code>deftype</code> and <code>defrecord</code>, it does not have accessible fields.</p>
</div>
<div class="paragraph">
<p>This is  how we can emulate an instance of the user type that plays well with the <code>IUser</code> abstraction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">user</span>
  <span class="tok-p">[</span><span class="tok-nv">firstname</span> <span class="tok-nv">lastname</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nf">reify</span>
    <span class="tok-nv">IUser</span>
    <span class="tok-p">(</span><span class="tok-nf">full-name</span> <span class="tok-p">[</span><span class="tok-nv">_</span><span class="tok-p">]</span>
      <span class="tok-p">(</span><span class="tok-nb">str </span><span class="tok-nv">firstname</span> <span class="tok-s">&quot; &quot;</span> <span class="tok-nv">lastname</span><span class="tok-p">))))</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">yen</span> <span class="tok-p">(</span><span class="tok-nf">user</span> <span class="tok-s">&quot;Yennefer&quot;</span> <span class="tok-s">&quot;of Vengerberg&quot;</span><span class="tok-p">))</span>
<span class="tok-p">(</span><span class="tok-nf">full-name</span> <span class="tok-nv">user</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;Yennefer of Vengerberg&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The real purpose of <code>reify</code> is to create an anonymous type that may implement protocols,
but you don&#8217;t want the type itself.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="host-interoperability"><a class="link" href="#host-interoperability">2.12. Host interoperability</a></h3>
<div class="paragraph">
<p><em>ClojureScript</em>, in the same way as it brother Clojure, is designed to be a "Guest" language. This means
that the design of the language works well on top of an existing ecosystem such as JavaScript
for <em>ClojureScript</em> and the JVM for <em>Clojure</em>.</p>
</div>
<div class="sect3">
<h4 id="the-types"><a class="link" href="#the-types">2.12.1. The types.</a></h4>
<div class="paragraph">
<p><em>ClojureScript</em> unlike what you might expect, tries to take advantage of every type that the platform provides. This
is a (perhaps incomplete) list of things that <em>ClojureScript</em> inherits and reuses from the underlying
platform:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ClojureScript</em> strings are javascript <strong>Strings</strong>.</p>
</li>
<li>
<p><em>ClojureScript</em> numbers are javascript <strong>Numbers</strong>.</p>
</li>
<li>
<p><em>ClojureScript</em> <code>nil</code> is a javascript <strong>null</strong>.</p>
</li>
<li>
<p><em>ClojureScript</em> regular expressions are javascript <code>RegExp</code> instances.</p>
</li>
<li>
<p><em>ClojureScript</em> is not interpreted; it is always compiled down to JavaScript.</p>
</li>
<li>
<p><em>ClojureScript</em> allows easy call to platform APIs with the same semantics.</p>
</li>
<li>
<p><em>ClojureScript</em> data types internally compile to objects in JavaScript.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On top of it, <em>ClojureScript</em> builds its own abstractions and types that do not exist in the
platform, such as Vectors, Maps, Sets, and others that are explained in previous sections of this chapter.</p>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-platform-types"><a class="link" href="#interacting-with-platform-types">2.12.2. Interacting with platform types</a></h4>
<div class="paragraph">
<p><em>ClojureScript</em> comes with a little set of special forms that allows it interact with platform
types such as calling object methods, creating new instances, and accessing object
properties.</p>
</div>
<div class="sect4">
<h5 id="access-to-the-platform"><a class="link" href="#access-to-the-platform">Access to the platform</a></h5>
<div class="paragraph">
<p><em>ClojureScript</em> has a special syntax for access to the entire platform environment through the
<code>js/</code> special namespace. This is an example of an expression to execute JavaScript&#8217;s
built-in <code>parseInt</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">js/parseInt</span> <span class="tok-s">&quot;222&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 222</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="creating-new-instances"><a class="link" href="#creating-new-instances">Creating new instances</a></h5>
<div class="paragraph">
<p><em>ClojureScript</em> has two ways to create instances:</p>
</div>
<div class="listingblock">
<div class="title">Using the <code>new</code> special form</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">new </span><span class="tok-nv">js/RegExp</span> <span class="tok-s">&quot;^foo$&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>.</code> special form</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">js/RegExp.</span> <span class="tok-s">&quot;^foo$&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The last one is the recommended way to create instances. We are not aware of real differences
between the two forms, but in the ClojureScript community the last one is used most often.</p>
</div>
</div>
<div class="sect4">
<h5 id="invoke-instance-methods"><a class="link" href="#invoke-instance-methods">Invoke instance methods</a></h5>
<div class="paragraph">
<p>To invoke methods of some object instance, as opposed to how it is done in JavaScript (e.g.,
<code>obj.method()</code>, the method name comes first like any other standard function in Lisp languages
but with a little variation: the function name starts with special form <code>.</code>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how we can call the <code>.test()</code> method of a regexp instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">re</span> <span class="tok-p">(</span><span class="tok-nf">js/RegExp</span> <span class="tok-s">&quot;^Clojure&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">.test</span> <span class="tok-nv">re</span> <span class="tok-s">&quot;ClojureScript&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="access-to-object-properties"><a class="link" href="#access-to-object-properties">Access to object properties</a></h5>
<div class="paragraph">
<p>Access to the object properties is really very similar to calling a method. The difference is that
instead of using the <code>.</code> you use <code>.-</code>. Let&#8217;s see an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">.-multiline</span> <span class="tok-nv">re</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; false</span>
<span class="tok-p">(</span><span class="tok-nf">.-PI</span> <span class="tok-nv">js/Math</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 3.141592653589793</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="javascript-objects"><a class="link" href="#javascript-objects">JavaScript objects</a></h5>
<div class="paragraph">
<p><em>ClojureScript</em> has different ways to create plain JavaScript objects, each one has its own
purpose. The basic one is the <code>js-obj</code> function. It accepts a variable number of pairs of keys and
values and returns a JavaScript object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">js-obj</span> <span class="tok-s">&quot;country&quot;</span> <span class="tok-s">&quot;FR&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; #js {:country &quot;FR&quot;}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The return value can be passed to some kind of third party library that accepts a plain
JavaScript object, but you can observe the real representation of the return value of this
function. It is really another other form for doing the same thing.</p>
</div>
<div class="paragraph">
<p>Using the reader macro <code>#js</code> consists of prepending it to a ClojureScript map or vector, and the
result will be transformed to plain JavaScript:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">myobj</span> <span class="tok-o">#</span><span class="tok-nv">js</span> <span class="tok-p">{</span><span class="tok-ss">:country</span> <span class="tok-s">&quot;FR&quot;</span><span class="tok-p">})</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The translation of that to plain javascript is similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span class="tok-kd">var</span> <span class="tok-nx">myobj</span> <span class="tok-o">=</span> <span class="tok-p">{</span><span class="tok-nx">country</span><span class="tok-o">:</span> <span class="tok-s2">&quot;FR&quot;</span><span class="tok-p">};</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As explained in previous section, you also can access to the plain object properties using
the <code>.-</code> syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">.-country</span> <span class="tok-nv">myobj</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; &quot;FR&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And as JavaScript objects are mutable, you can set a new value for some property using
the <code>set!</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">set!</span> <span class="tok-p">(</span><span class="tok-nf">.-country</span> <span class="tok-nv">myobj</span><span class="tok-p">)</span> <span class="tok-s">&quot;KR&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="conversions"><a class="link" href="#conversions">Conversions</a></h5>
<div class="paragraph">
<p>The inconvenience of the previously explained forms is that they does not make recursive
transformations, so if you have nested objects, the nested objects will not be converted.
To solve that use cases <em>ClojureScript</em> comes with the <code>clj&#8594;js</code> and <code>js&#8594;clj</code> functions
that transform clojure collection types into JavaScript and back:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">clj-&gt;js</span> <span class="tok-p">{</span><span class="tok-ss">:foo</span> <span class="tok-p">{</span><span class="tok-ss">:bar</span> <span class="tok-s">&quot;baz&quot;</span><span class="tok-p">}})</span>
<span class="tok-c1">;; =&gt; #js {:foo #js {:bar &quot;baz&quot;}}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case of arrays, there is a specialized function <code>into-array</code> that behaves as expected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">into-array </span><span class="tok-p">[</span><span class="tok-s">&quot;France&quot;</span> <span class="tok-s">&quot;Korea&quot;</span> <span class="tok-s">&quot;Peru&quot;</span><span class="tok-p">])</span>
<span class="tok-c1">;; =&gt; #js [&quot;France&quot; &quot;Korea&quot; &quot;Peru&quot;]</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="arrays"><a class="link" href="#arrays">Arrays</a></h5>
<div class="paragraph">
<p>In previous example we have seen how we can create an array from an existing <em>ClojureScript</em>
collection. But there is another function for creating arrays: <code>make-array</code>.</p>
</div>
<div class="listingblock">
<div class="title">Creating a preallocated array with length 10</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">a</span> <span class="tok-p">(</span><span class="tok-nb">make-array </span><span class="tok-mi">10</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; #js [nil nil nil nil nil nil nil nil nil nil]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In <em>ClojureScript</em> arrays also play well with sequence abstractions so you can iterate
over them or simply get the number of elements with the <code>count</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">count </span><span class="tok-nv">a</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 10</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As arrays on the JavaScript platform are a mutable collection type, you can access a concrete index
and set the value at that position:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">aset </span><span class="tok-nv">a</span> <span class="tok-mi">0</span> <span class="tok-mi">2</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 2</span>
<span class="tok-nv">a</span>
<span class="tok-c1">;; =&gt; #js [2 nil nil nil nil nil nil nil nil nil]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or access in a indexed way to get its values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nb">aget </span><span class="tok-nv">a</span> <span class="tok-mi">0</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 2</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In JavaScript, objects are also arrays, so you can use the same functions for interacting
with plain objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">b</span> <span class="tok-o">#</span><span class="tok-nv">js</span> <span class="tok-p">{</span><span class="tok-ss">:hour</span> <span class="tok-mi">16</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; #js {:hour 16}</span>

<span class="tok-p">(</span><span class="tok-nb">aget </span><span class="tok-nv">b</span> <span class="tok-s">&quot;hour&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 16</span>

<span class="tok-p">(</span><span class="tok-nb">aset </span><span class="tok-nv">b</span> <span class="tok-s">&quot;minute&quot;</span> <span class="tok-mi">22</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 22</span>

<span class="tok-nv">b</span>
<span class="tok-c1">;; =&gt; #js {:hour 16, :minute 22}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="state-management"><a class="link" href="#state-management">2.13. State management</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="truthiness"><a class="link" href="#truthiness">2.14. Truthiness</a></h3>
<div class="paragraph">
<p>This is the aspect where each language has its own semantics. The majority of languages
consider empty collections, the integer 0, and other things like this to be false.
In <em>ClojureScript</em>, unlike in other languages, only two values are considered as false: <code>nil</code>
and <code>false</code>, Everything else is treated as <code>true</code>.</p>
</div>
<div class="paragraph">
<p>So, thanks to this, sets can be also be considered as predicates. If a set returns a value, it exists,
and if it returns <code>nil</code> the value does not exist:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">s</span> <span class="tok-o">#</span><span class="tok-p">{</span><span class="tok-mi">1</span> <span class="tok-mi">2</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-nf">s</span> <span class="tok-mi">1</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 1</span>

<span class="tok-p">(</span><span class="tok-nf">s</span> <span class="tok-mi">3</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; nil</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transducers"><a class="link" href="#transducers">2.15. Transducers</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="metadata"><a class="link" href="#metadata">2.16. Metadata</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="a-little-overview-of-macros"><a class="link" href="#a-little-overview-of-macros">2.17. A little overview of macros</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tooling-compiler"><a class="link" href="#tooling-compiler">3. Tooling &amp; Compiler</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will cover a little introduction to existing tooling for making things easy when
developing using ClojureScript. It will cover:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the repl</p>
</li>
<li>
<p>Leiningen and cljsbuild</p>
</li>
<li>
<p>Google Closure Library</p>
</li>
<li>
<p>Modules</p>
</li>
<li>
<p>Unit testing</p>
</li>
<li>
<p>Library development</p>
</li>
<li>
<p>Browser based development</p>
</li>
<li>
<p>Server based development</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unlike the previous chapter, this chapter intends to tell different stories each independent of each other.</p>
</div>
<div class="sect2">
<h3 id="getting-started-with-the-clojurescript-compiler"><a class="link" href="#getting-started-with-the-clojurescript-compiler">3.1. Getting Started with the ClojureScript compiler</a></h3>
<div class="paragraph">
<p>At this point, you are surely very bored with the constant theoretical explanations about the language
itself and will want to write and execute some code. The goal of this section is to provide a little practical
introduction to the <em>ClojureScript</em> compiler.</p>
</div>
<div class="paragraph">
<p>The <em>ClojureScript</em> compiler takes the source code that has been split over numerous directories and namespaces and
compiles it down to JavaScript. Today, JavaScript has great number of different environments
where it can be executed - each with its own pecularities.</p>
</div>
<div class="paragraph">
<p>This chapter intends to explain how to use <em>ClojureScript</em> without any additional tooling. This
will help you understand how the compiler works and how you can use it when other tooling is not
available (such as leiningen+cljsbuld or boot).</p>
</div>
<div class="sect3">
<h4 id="execution-environments"><a class="link" href="#execution-environments">3.1.1. Execution environments</a></h4>
<div class="paragraph">
<p>What is an execution environment? An execution environment is an engine where JavaScript can be
executed. For example, the most popular execution environment is a browser (Chrome, Firefox, &#8230;&#8203;)
followed by the second most popular - nodejs/iojs.</p>
</div>
<div class="paragraph">
<p>There are others, such as Rhino (jdk6+), Nashorn (jdk8), QtQuick (QT),&#8230;&#8203; but none of them have
significant differences from the first two. So, <em>ClojureScript</em> at the moment may compile
code to run in the browser or in nodejs/iojs like environments out of the box.</p>
</div>
</div>
<div class="sect3">
<h4 id="download-the-compiler"><a class="link" href="#download-the-compiler">3.1.2. Download the compiler</a></h4>
<div class="paragraph">
<p>The <em>ClojureScript</em> compiler is implemented in java, and to use it, you should have jdk8 installed.
<em>ClojureScript</em> itself only requires jdk7, but the standalone compiler that we going to use in this
chapter requires jdk8 which can be found at <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" class="bare">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></p>
</div>
<div class="paragraph">
<p>You can download it using <code>wget</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">wget https://github.com/clojure/clojurescript/releases/download/r3211/cljs.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>ClojureScript</em> compiler is packaged in a standalone executable jar file, so this is the only
file and JDK8 that you need to compile the <em>ClojureScript</em> source code to JavaScript.</p>
</div>
</div>
<div class="sect3">
<h4 id="compile-for-nodejs-iojs"><a class="link" href="#compile-for-nodejs-iojs">3.1.3. Compile for nodejs/iojs</a></h4>
<div class="paragraph">
<p>Let start with a practical example compiling code that will target <strong>nodejs</strong>/<strong>iojs</strong>. For
this example you should have nodejs or iojs (recommended) installed.</p>
</div>
<div class="paragraph">
<p>There are different ways to install iojs, but the recommended way is using nvm (node version
manager). You can read the instructions to install and use nvm at: <a href="https://github.com/creationix/nvm">home page</a>.</p>
</div>
<div class="paragraph">
<p>You can test if <strong>iojs</strong> is installed in your system with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ iojs --version
v1.7.1</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="create-the-example-application"><a class="link" href="#create-the-example-application">Create the example application</a></h5>
<div class="paragraph">
<p>For the first step of our practical example, we will create our application directory structure
and populate it with example code.</p>
</div>
<div class="paragraph">
<p>So start creating the directory tree structure for our "hello world" application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">mkdir -p src/myapp
touch src/myapp/core.cljs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Second, write the example code into the previously created <code>src/myapp/core.cljs</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.core</span>
  <span class="tok-p">(</span><span class="tok-ss">:require</span> <span class="tok-p">[</span><span class="tok-nv">cljs.nodejs</span> <span class="tok-ss">:as</span> <span class="tok-nv">nodejs</span><span class="tok-p">]))</span>

<span class="tok-p">(</span><span class="tok-nf">nodejs/enable-util-print!</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">-main</span> <span class="tok-p">[</span><span class="tok-o">&amp;</span> <span class="tok-nv">args</span><span class="tok-p">]</span>
  <span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Hello world!&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nf">set!</span> <span class="tok-nv">*main-cli-fn*</span> <span class="tok-nv">-main</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is very important that the declared namespace in the file exactly matches the directory
structure. This is the way <em>ClojureScript</em> structures its source code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="compile-the-example-application"><a class="link" href="#compile-the-example-application">Compile the example application</a></h5>
<div class="paragraph">
<p>In order to compile that source code, we need a simple build script that instructs the
<em>ClojureScript</em> compiler with the source directory and the output file. <em>ClojureScript</em> has a
lot of other options but at this moment we can ignore that.</p>
</div>
<div class="paragraph">
<p>Lets create the <em>build.clj</em> file with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-ss">&#39;cljs.closure</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nf">cljs.closure/build</span> <span class="tok-s">&quot;src&quot;</span>
 <span class="tok-p">{</span><span class="tok-ss">:output-to</span> <span class="tok-s">&quot;main.js&quot;</span>
  <span class="tok-ss">:main</span> <span class="tok-ss">&#39;myapp.core</span>
  <span class="tok-ss">:target</span> <span class="tok-ss">:nodejs</span><span class="tok-p">})</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a brief explanation of the compiler options used in this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>:output-to</code> parameter indicates to the compiler the destination of the compiled code, in this
case to the "main.js" file.</p>
</li>
<li>
<p>The <code>:main</code> property indicates to the compiler the namespace that will act as the entry point of
your application when it&#8217;s executed.</p>
</li>
<li>
<p>The <code>:target</code> property indicates the platform where you want execute the compiled code. In this case
we are going to use <strong>iojs</strong> (formerly nodejs). If you omit this parameter, the source will be
compiled to run in the browser environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the compilation, just execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">java -cp cljs.jar:src clojure.main build.clj</code></pre>
</div>
</div>
<div class="paragraph">
<p>And when it finishes, execute the compiled file using <strong>iojs</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ iojs main.js
Hello world!</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="compile-for-the-browser"><a class="link" href="#compile-for-the-browser">3.1.4. Compile for the Browser</a></h4>
<div class="paragraph">
<p>In this section we are going to create a similar "hello world" example application from the
previous section to run in the browser environent. The minimal requirement for it
is just a browser that can execute JavaScript.</p>
</div>
<div class="paragraph">
<p>The process is almost the same, the directory structure is the same. The only things that
changes is the entry point of the application and the build script.</p>
</div>
<div class="paragraph">
<p>Start writing new content to the <code>src/myapp/core.cljs</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-kd">ns </span><span class="tok-nv">myapp.core</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nf">enable-console-print!</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nb">println </span><span class="tok-s">&quot;Hello world!&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the browser environment we do not need a specific entry point for the application,
so the entry point is the entire namespace.</p>
</div>
<div class="sect4">
<h5 id="compile-the-example-application-2"><a class="link" href="#compile-the-example-application-2">Compile the example application</a></h5>
<div class="paragraph">
<p>In order to compile the source code to run properly in a browser, overwrite
the <em>build.clj</em> file with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-ss">&#39;cljs.closure</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nf">cljs.closure/build</span> <span class="tok-s">&quot;src&quot;</span>
 <span class="tok-p">{</span><span class="tok-ss">:output-to</span> <span class="tok-s">&quot;main.js&quot;</span>
  <span class="tok-ss">:output-dir</span> <span class="tok-s">&quot;out/&quot;</span>
  <span class="tok-ss">:source-map</span> <span class="tok-s">&quot;main.js.map&quot;</span>
  <span class="tok-ss">:main</span> <span class="tok-ss">&#39;myapp.core</span>
  <span class="tok-ss">:optimizations</span> <span class="tok-ss">:none</span><span class="tok-p">})</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a brief explanation of the compiler options we&#8217;re using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>:output-to</code> parameter indicates to the compiler the destination of the compiled code, in this
case to the "main.js" file.</p>
</li>
<li>
<p>The <code>:main</code> property indicates to the compiler the namespace that will act as the entry point of
your application when it&#8217;s executed.</p>
</li>
<li>
<p><code>:source-map</code> indicates the destination of the source map. (The source map connects the ClojureScript source
to the generated JavaScript so that error messages can point you back to the original source.)</p>
</li>
<li>
<p><code>:output-dir</code> indicates the destination directory for all files sources used in a compilation. It is
just for making source maps work properly with the rest of code, not only your source.</p>
</li>
<li>
<p><code>:optimizations</code> indicates the compilation optimization. There are different values for this option,
but that will be covered in following sections in more detail.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the compilation, just execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">java -cp cljs.jar:src clojure.main build.clj</code></pre>
</div>
</div>
<div class="paragraph">
<p>This process can take some time, so do not worry, wait a little bit. The JVM bootstrap with Clojure
compiler is slightly slow. In the following sections we will explain how to start a watch process to avoid
constantly starting and stopping this slow process.</p>
</div>
<div class="paragraph">
<p>While waiting for the compilation, let&#8217;s create a dummy HTML file to make it easy to execute our example
app in the browser. Create the <em>index.html</em> file with the following content; it goes in the main <em>myapp</em>
directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="html"><span class="tok-cp">&lt;!DOCTYPE html&gt;</span>
<span class="tok-nt">&lt;html&gt;</span>
  <span class="tok-nt">&lt;header&gt;</span>
    <span class="tok-nt">&lt;meta</span> <span class="tok-na">charset=</span><span class="tok-s">&quot;utf-8&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;title&gt;</span>Hello World from ClojureScript<span class="tok-nt">&lt;/title&gt;</span>
  <span class="tok-nt">&lt;/header&gt;</span>
  <span class="tok-nt">&lt;body&gt;</span>
    <span class="tok-nt">&lt;script </span><span class="tok-na">src=</span><span class="tok-s">&quot;main.js&quot;</span><span class="tok-nt">&gt;&lt;/script&gt;</span>
  <span class="tok-nt">&lt;/body&gt;</span>
<span class="tok-nt">&lt;/html&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, when the compilation finishes and you have the basic HTML file you can just open it with your favorite
browser and take a look in the development tools console. There should appear the "hello world" message.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="watch-process"><a class="link" href="#watch-process">3.1.5. Watch process</a></h4>
<div class="paragraph">
<p>Surely, you have already experienced the slow startup of the <em>ClojureScript</em> compiler. To solve this,
the <em>ClojureScript</em> standalone compiler also comes with tools to start a process that watches the changes
in some directory and perform an incremental compilation.</p>
</div>
<div class="paragraph">
<p>Start creating another build script, but in this case name it <em>watch.clj</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-ss">&#39;cljs.closure</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nf">cljs.closure/watch</span> <span class="tok-s">&quot;src&quot;</span>
 <span class="tok-p">{</span><span class="tok-ss">:output-to</span> <span class="tok-s">&quot;main.js&quot;</span>
  <span class="tok-ss">:output-dir</span> <span class="tok-s">&quot;out/&quot;</span>
  <span class="tok-ss">:source-map</span> <span class="tok-s">&quot;main.js.map&quot;</span>
  <span class="tok-ss">:main</span> <span class="tok-ss">&#39;myapp.core</span>
  <span class="tok-ss">:optimizations</span> <span class="tok-ss">:none</span><span class="tok-p">})</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, execute that script like any other that you have executed in previous sections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>java -cp cljs.jar:src clojure.main watch.clj
Building ...
Reading analysis cache <span class="tok-k">for</span> jar:file:/home/niwi/cljsbook/playground/cljs.jar!/cljs/core.cljs
Compiling out/cljs/core.cljs
Using cached cljs.core out/cljs/core.cljs
... <span class="tok-k">done</span>. Elapsed 0.8354759 seconds
Watching paths: /home/niwi/cljsbook/playground/src

Change detected, recompiling ...
Compiling src/myapp/core.cljs
Compiling out/cljs/core.cljs
Using cached cljs.core out/cljs/core.cljs
... <span class="tok-k">done</span>. Elapsed 0.191963443 seconds</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can observe that in the second compilation, the time is drastically reduced. Another advantage
of this method is that it is a gives a little bit more output.</p>
</div>
</div>
<div class="sect3">
<h4 id="optimization-levels"><a class="link" href="#optimization-levels">3.1.6. Optimization levels</a></h4>
<div class="paragraph">
<p>The <em>ClojureScript</em> compiler has different level of optimizations. Behind the scenes, those compilation
levels are coming from Google Closure Compiler.</p>
</div>
<div class="paragraph">
<p>A very simplified overview of the compilation process is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The reader reads the code and makes some analysis. This process can raise some warnings
during its phase.</p>
</li>
<li>
<p>Then, the <em>ClojureScript</em> compiler emits JavaScript code. The result of that is one JavaScript
file for each cljs file.</p>
</li>
<li>
<p>The generated files passes through the Closure Compiler that depending on the optimization level,
and other options (sourcemaps, output dir output to, &#8230;&#8203;) generates the final output.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The final output depends strictly on the optimization level.</p>
</div>
<div class="sect4">
<h5 id="none"><a class="link" href="#none">none</a></h5>
<div class="paragraph">
<p>Implies that closure compiler just writes the files as is, without any additional
optimization applied to the source code. This optimization level is mandatory if you are targeting
<strong>nodejs</strong> or <strong>iojs</strong> and is appropiate in development mode when your code targets the browser.</p>
</div>
</div>
<div class="sect4">
<h5 id="whitespace"><a class="link" href="#whitespace">whitespace</a></h5>
<div class="paragraph">
<p>This optimization level consists of concatenating the compiled files in an appropriate order, removing
line breaks and other whitespace and generating the output as one large file.</p>
</div>
<div class="paragraph">
<p>It also has some compilation speed penalty, resulting in slower compilations. In any case, it is not
terribly slow and is completely usable in small/medium applications.</p>
</div>
</div>
<div class="sect4">
<h5 id="simple"><a class="link" href="#simple">simple</a></h5>
<div class="paragraph">
<p>The simple compilation level implies (includes) all transformations from whitespace optimization and
additionally performs optimizations within expressions and functions, including renaming local variables
and function parameters to shorter names.</p>
</div>
<div class="paragraph">
<p>Compilation with the <code>:simple</code> optimization always preserves the functionality of syntactically valid
JavaScript, so it does not interfere with the interaction between the compiled <em>ClojureScript</em> and
other JavaScript.</p>
</div>
</div>
<div class="sect4">
<h5 id="advanced"><a class="link" href="#advanced">advanced</a></h5>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working-with-the-repl"><a class="link" href="#working-with-the-repl">3.2. Working with the REPL</a></h3>
<div class="sect3">
<h4 id="introduction-2"><a class="link" href="#introduction-2">3.2.1. Introduction</a></h4>
<div class="paragraph">
<p>Although you can create a source file and compile it every time you want to try something out in
ClojureScript, it&#8217;s easier to use the REPL. REPL stands for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read - get input from the keyboard</p>
</li>
<li>
<p>Evaluate the input</p>
</li>
<li>
<p>Print the result</p>
</li>
<li>
<p>Loop back for more input</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words, the REPL lets you try out ClojureScript concepts and get immediate feedback.</p>
</div>
</div>
<div class="sect3">
<h4 id="node-repl"><a class="link" href="#node-repl">3.2.2. Node REPL</a></h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect3">
<h4 id="nashorn-repl"><a class="link" href="#nashorn-repl">3.2.3. Nashorn REPL</a></h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect3">
<h4 id="browser-repl"><a class="link" href="#browser-repl">3.2.4. Browser REPL</a></h4>
<div class="paragraph">
<p>Let start creating a file named <code>brepl.clj</code> with the following content, adapted from the
[ClojureScript Quick Start Wiki Page](<a href="https://github.com/clojure/clojurescript/wiki/Quick-Start" class="bare">https://github.com/clojure/clojurescript/wiki/Quick-Start</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-ss">&#39;cljs.repl</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-ss">&#39;cljs.closure</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-ss">&#39;cljs.repl.browser</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nf">cljs.closure/build</span> <span class="tok-s">&quot;src&quot;</span>
  <span class="tok-p">{</span><span class="tok-ss">:main</span> <span class="tok-ss">&#39;myapp.core</span>
   <span class="tok-ss">:output-to</span> <span class="tok-s">&quot;main.js&quot;</span>
   <span class="tok-ss">:verbose</span> <span class="tok-nv">true</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-nf">cljs.repl/repl</span> <span class="tok-p">(</span><span class="tok-nf">cljs.repl.browser/repl-env</span><span class="tok-p">)</span>
  <span class="tok-ss">:watch</span> <span class="tok-s">&quot;src&quot;</span>
  <span class="tok-ss">:output-dir</span> <span class="tok-s">&quot;out/&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This script builds the source, just as we did earlier, and then starts the REPL.
It then runs the REPL. watching the source directory for any changes. The REPL starts
a mini web server to display your web page. You must change your ClojureScript code
to connect your script to the REPL.  Change the source code in <em>src/myapp/core.cljs</em> to read:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(ns myapp.core
 (:require [clojure.browser.repl :as repl]))

(defonce conn
  (repl/connect "http://localhost:9000/repl"))

(enable-console-print!)

(println "Hello, world!")</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>:require</code> has changed to use code from the <code>clojure.browser.repl</code> library, and then defines a
connection to the REPL, which will be running on port 9000 of ClojureScript&#8217;s mini-server.</p>
</div>
<div class="paragraph">
<p>There’s one more step to take. On Linux and Mac OSX, the REPL doesn’t automatically let you use the arrow
keys to move back and forth within a line or up and down to see previously entered input. Instead, you
need to use the <code>rlwrap</code> program to give you that capability. (Its name comes from the fact that it
wraps the “readline” utility around other programs.)</p>
</div>
<div class="paragraph">
<p>Well, that was a lot of setup! But trust us, it’s all worth it when you see it in action.
Here it is, with a ClojureScript expression typed in as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span class="tok-nv">$ </span>rlwrap java -cp cljs.jar:src clojure.main brepl.clj
Compiling client js ...
Waiting <span class="tok-k">for</span> browser to connect ...
Watch compilation log available at: out/watch.log
To quit, <span class="tok-nb">type</span>: :cljs/quit
cljs.user<span class="tok-o">=</span>&gt; <span class="tok-o">(</span>+ <span class="tok-m">14</span> 28<span class="tok-o">)</span>
42
cljs.user<span class="tok-o">=</span>&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since you are watching the source code, if you make changes, your program will recompile, and the
compiler output will go to the <em>watch.log</em> file in the <em>out</em> directory. If you are on Mac OSX or
Linux, you can open up a new terminal window and use this command to see the contents of the file
continuously updated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>tail -f out/watch.log</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build-and-dependency-management-tools"><a class="link" href="#build-and-dependency-management-tools">3.3. Build and Dependency management tools</a></h3>
<div class="sect3">
<h4 id="getting-started-with-leiningen"><a class="link" href="#getting-started-with-leiningen">3.3.1. Getting started with Leiningen.</a></h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect3">
<h4 id="getting-started-with-boot"><a class="link" href="#getting-started-with-boot">3.3.2. Getting started with boot.</a></h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-closure-library"><a class="link" href="#the-closure-library">3.4. The Closure Library</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="browser-based-development"><a class="link" href="#browser-based-development">3.5. Browser based development</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
<div class="sect3">
<h4 id="using-third-party-javascript-libraries"><a class="link" href="#using-third-party-javascript-libraries">3.5.1. Using third party JavaScript libraries</a></h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect3">
<h4 id="modularizing-your-code"><a class="link" href="#modularizing-your-code">3.5.2. Modularizing your code</a></h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="developing-a-library"><a class="link" href="#developing-a-library">3.6. Developing a library</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="unit-testing"><a class="link" href="#unit-testing">3.7. Unit testing</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mixed-bag"><a class="link" href="#mixed-bag">4. Mixed Bag</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter will cover miscellaneous topics that are not classified in the previous ones. This is a
"catchall" section and will touch a bunch of heterogeneus topics like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Async primitives using the <em>core.async</em> library.</p>
</li>
<li>
<p>Working with promises.</p>
</li>
<li>
<p>Error handling using the <em>cats</em> library.</p>
</li>
<li>
<p>Pattern matching with the <em>core.match</em> library.</p>
</li>
<li>
<p>Web development using the Om library.</p>
</li>
<li>
<p>Share code between clojure and clojurescript.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="async-primitives-using-core-async"><a class="link" href="#async-primitives-using-core-async">4.1. Async primitives using core.async.</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="working-with-promises"><a class="link" href="#working-with-promises">4.2. Working with promises.</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="error-handling-using-monads-and-cats"><a class="link" href="#error-handling-using-monads-and-cats">4.3. Error handling using monads and Cats.</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="pattern-matching-using-core-match"><a class="link" href="#pattern-matching-using-core-match">4.4. Pattern matching using core.match.</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="web-development-with-om-and-react"><a class="link" href="#web-development-with-om-and-react">4.5. Web development with Om and React.</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="writing-libraries-that-shares-code-between-clojure-and-clojurescript"><a class="link" href="#writing-libraries-that-shares-code-between-clojure-and-clojurescript">4.6. Writing libraries that shares code between Clojure and ClojureScript.</a></h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1<br/>
Last updated 2015-05-07 23:29:51 CEST
</div>
</div>
</body>
</html>